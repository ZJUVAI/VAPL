{"version":3,"sources":["components/server.ts","components/panelHeader/PanelHeader.tsx","locales/ja.ts","locales/en.ts","locales/translate.ts","store/index.js","components/editor/Editor.tsx","panels/editorPanel/EditorPanel.tsx","components/console/Console.tsx","panels/consolePanel/ConsolePanel.tsx","components/timeline/StatementHighlightContent.tsx","assets/icon/timelineLegend.svg","components/timeline/Slider.tsx","assets/icon/stepLight.svg","assets/icon/stepDark.svg","assets/icon/restartLight.svg","assets/icon/restartDark.svg","assets/icon/stepBackLight.svg","assets/icon/stepBackDark.svg","assets/icon/kaishi2.svg","assets/icon/kaishi1.svg","components/timeline/ControButton.tsx","components/timeline/ControlButtonGroup.tsx","panels/timelinePanel/TimelinePanel.tsx","components/callStack/blockDrawer/BlockDrawer.tsx","components/callStack/block/Block.tsx","components/callStack/CallStack.tsx","components/callStack/animation/AnimationDrawer.tsx","panels/callStackPanel/CallStackPanel.tsx","components/memory/memoryBlock/MemoryCell.tsx","components/memory/memoryBlock/MemoryBlock.tsx","components/memory/LogicalView.tsx","assets/icon/binaryCode/intLegend1.svg","assets/icon/binaryCode/intLegend2.svg","assets/icon/binaryCode/intLegend3.svg","assets/icon/binaryCode/intLegend4.svg","assets/icon/binaryCode/intMark1.svg","assets/icon/binaryCode/intMark2.svg","components/memory/binaryCodeSvg/IntegerBinaryCode.tsx","components/memory/binaryCodeSvg/FloatBinaryCode.tsx","components/memory/binaryCodeSvg/BinaryCodeSvg.tsx","components/memory/MemoryDetail.tsx","components/memory/PhysicalView.tsx","components/subtitleBlock/SubtitleBlock.tsx","panels/memoryPanel/MemoryPanel.tsx","assets/icon/logo.svg","assets/icon/info.svg","assets/icon/icon2.svg","components/appHeader/AppHeader.tsx","App.tsx","reportWebVitals.ts","index.tsx","components/emitter.tsx"],"names":["server","timer","isExecuting","files","Map","count","interpreter","stateHistory","outputsHistory","progLang","Error","module","this","CPP14Interpreter","Java8Interpreter","Python3Interpreter","dynamicLoadInterpreter","setFileList","file","reader","FileReader","Promise","resolve","reject","onerror","abort","DOMException","onload","result","ArrayBuffer","set","name","readAsArrayBuffer","all","Array","from","map","addFile","filename","delete","request","controlEvent","sourcecode","stdinText","lineNumOfBreakpoint","step","Start","Stop","BackAll","StepBack","Step","StepAll","JumpTo","Exec","SyntaxCheck","reset","lineCount","split","length","state","startStepExecution","execState","recordExecState","stdout","getStdout","output","recordOutputText","linesShowUp","allVariables","variableShowUp","i","push","lineNumber","steps","color","depth","visible","ret","debugState","errors","currentExpr","getCurrentExpr","nextExpr","getNextExpr","stacks","getStacks","functionName","Number","nCodeRange","codeRange","begin","y","forEach","stack","stackName","getVariables","variable","inArray","Object","keys","funcName","currentClassName","constructor","UniBinOp","res","binOp","variableName","lastExpr","nextClassName","uniReturn","returnBinOp","stepCount","outputChange","isOutputChange","uniBinOp","operator","right","UniMethodCall","methodName","left","UniIdent","UniUnaryOp","expr","variables","clearTimeout","undefined","lastState","getIsWaitingForStdin","stdin","stepExecute","isStepExecutionRunning","getLastHistory","currentCount","loop","includes","signal","global","setTimeout","bind","code","checkSyntaxError","PanelHeader","title","className","howToUse","close","debugStart","debugStop","debugBackAll","debugStepBack","debugStep","debugStepAll","changeThemedark","changeThemelight","zoomOut","zoomIn","zoomReset","howToText","uploadFile","warning","editInDebug","continueDebug","restart","rememberCommand","sourceCodeCcpp","String","raw","sourceCodeJava","sourceCodePython","translate","lang","key","ja","en","ADD_ITEM","REMOVE_ITEM","ADD_VAR","initState","statements","palette","variablesPalette","id","existColor","Set","getHashColor","index","has","add","getColor","size","reducer","action","type","data","old","rest","console","log","join","Editor","props","sentSourcecode","preventedCommand","ace","editorRef","React","isDebugging","checkbox","noAlert","highlightIds","sourceCodeKey","prog","replace","char","toUpperCase","fontSize","showAlert","theme","hideAlert","setHighlightOnCode","slot","send","sessionStorage","setItem","then","response","recieve","catch","e","alert","command","setState","Math","max","a","editor","current","on","acequire","Range","target","domEvent","currentTarget","indexOf","isFocused","clientX","getBoundingClientRect","row","getDocumentPosition","session","getSession","clearBreakpoint","filter","n","d3","d","style","removeHighlightStatement","message","setBreakpoint","addHighlightStatement","stop","remove","setSyntaxError","AceRange","range","x","end","resize","scrollToLine","getSelection","setSelectionRange","annotations","error","line","column","charPositionInLine","text","getMsg","setAnnotations","highlightId","removeMarker","annotation","highlightLines","renderAlert","renderEditor","mode","ref","value","tabSize","editorProps","$blockScrolling","Infinity","setOptions","enableBasicAutocompletion","enableLiveAutocompletion","showLineNumbers","readOnly","height","width","onChange","onBeforeLoad","Dialog","aria-labelledby","tabIndex","role","Header","closeButton","Title","bsStyle","Footer","onClick","checked","validationState","inputRef","mapDispatchToProps","connect","EditorPanel","Console","isReadOnly","endsWith","sendText","slice","transition","duration","tween","j","t","delay","showGutter","marginTop","ConsolePanel","StatementHighlightContent","changeStatementVisible","background","Slider","rectScale","maxDepth","domain","dragStart","stopPropagation","dragging","dragEnd","dragFromSVG","scale","invert","nativeEvent","offsetX","min","round","mouseMove","window","addEventListener","removeEventListener","variableHighlights","statementHighlights","contentWidth","activeWidth","display","zIndex","overflow","onMouseDown","onMouseMove","rx","ry","m","_step","fill","xlinkHref","timelineLegend","ControlButton","iconHrefLight","iconHrefDark","disabled","classNames","cursor","ControlButtonGroup","useState","start","setStart","setStop","setBackAll","stepBack","setStepBack","setStep","setStepAll","useEffect","stepBackLight","stepBackDark","restartLight","startLight","restartDark","startDark","arrowListJson","getItem","arrowList","JSON","parse","select","attr","clear","stepLight","stepDark","TimelinePanel","variableShowUps","updVariableShowUps","setMax","setVariableHighlights","setStatementHighlights","setLinesShowUp","setDebugStatus","setDebugState","timelineArea","createRef","timelineWidth","setTimelineWidth","useSelector","statement","floor","random","formatRgb","splice","options","temp","label","children","varName","unstable_batchedUpdates","debugStatus","useCallback","lines","clientWidth","useMemo","values","highlights","linear","arrayToString","array","isArray","fromCharCode","v","startsWith","valueToArray","toString","BlockDrawer","blockStacks","blockArrows","update","calcPos","blockStack","BlockStack","setColor","getName","calcStackPos","setPos","originX","originY","getBlockTable","blockCellContainer","_x","BlockCell","WIDTH","_y","HEIGHT","calcVariablePos","setHeight","offsetY","setWidth","pos","Vector","blockTable","makeBlockTable","setAxes","getValue","cellss","BlockArrayVariable","BlockVariable","getBlockCellContainer","getX","getY","init","address","cell","pushCell","setType","setAddress","table","concat","parentKey","FONT_SIZE","Block","each","word","words","reverse","tspan","append","pop","node","getComputedTextLength","getWidth","getHeight","stroke","strokeWidth","list","blockCell","transform","fontWeight","backgroud","renderBlockBackground","content","renderBlockContent","renderArrow","sourceStackName","targetStackName","source","empty","sourceX","sourceY","targetX","getBBox","targetY","CallStack","blockDrawer","getBlockStacks","getBlockArrows","stringify","nextProps","nextBlockStacks","blockStacksLen","nextBlockStacksLen","appendClone","clonedBlock","selectAll","block","block_node","parentNode","blocks","drawOrRemoveBlock","transform-origin","renderStackView","renderBlocks","AnimationDrawer","variableKeys","variableTypes","variableValues","postArgs","getCurrentStack","parseExe","lastClassName","variableDec","methodCall","uniMethodCall","getMethodArgs","uniVariableDec","variableDef","uniVariableDef","variableValue","returnValue","travelValue","returnValueClass","arg","idx","travelArg","args","CallStackPanel","variableWithSteps","variableChanged","highlightChangedVariable","resetVariableColor","viewBox","refX","refY","markerWidth","markerHeight","orient","cx","cy","r","Component","lastStacks","execStacks","lastValue","curValue","getValueFromStack","targetVariable","blockElement","highlightColor","defaultColor","MemoryCell","selectedVar","handleClick","dataType","active","arr","firstVarInArr","MemoryBlock","Variable","LogicalView","allStacks","setAllStacks","setHeap","setGlobal","curStacks","curHeap","curGlobal","p","substring","IntegerBinaryCode","binaryCode0","signMagn","binaryCode1","oneComp","binaryCode2","oneC","d2b","parseInt","twoComp","sign","intLegend1","intLegend2","intLegend3","intLegend4","markerUnits","x1","y1","x2","y2","points","markerEnd","intMark1","intMark2","num","FloatBinaryCode","float2binary","exponent","mantissa","binary","pointPos","firstOne","DefaultBinayCode","BinaryCodeSvg","getBinaryCodeSvg","defaultMemoryInfo","MemoryDetail","memoryInfo","PhysicalView","SubtitleBlock","isActive","defaultVar","MemoryPanel","viewMode","setViewMode","setSelectedVar","lastVar","setLastVar","handleModeChange","handleSelectMemory","newSelectedVar","hideDetail","AppHeader","logo","placement","trigger","overlayClassName","menuIcon1","menuIcon2","App","setExecState","setLastState","setVariableShowUps","app","onKeyDown","preventDefault","ctrlKey","focus","Fragment","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","store","createStore","ReactDOM","render","StrictMode","document","getElementById","emitter","EventEmitter","setMaxListeners","event","listener","emit","removeAllListeners"],"mappings":"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","file":"static/js/main.598e5c98.chunk.js","sourcesContent":["import { SyntaxErrorData } from 'unicoen.ts/dist/interpreter/mapper/SyntaxErrorData';\r\nimport { ExecState } from 'unicoen.ts/dist/interpreter/Engine/ExecState';\r\nimport { signal } from './emitter';\r\nimport { Interpreter } from 'unicoen.ts/dist/interpreter/Interpreter';\r\nimport { inArray } from 'jquery';\r\nimport { UniBinOp } from 'unicoen.ts/dist/node/UniBinOp';\r\nimport { UniExpr, UniMethodCall, UniIdent, UniUnaryOp } from 'unicoen.ts';\r\nimport { Variable } from 'unicoen.ts/dist/interpreter/Engine/Variable';\r\n\r\nexport type CONTROL_EVENT =\r\n  | 'Exec'\r\n  | 'Start'\r\n  | 'Stop'\r\n  | 'BackAll'\r\n  | 'StepBack'\r\n  | 'Step'\r\n  | 'StepAll'\r\n  | 'SyntaxCheck'\r\n  | 'JumpTo';\r\nexport type DEBUG_STATE =\r\n  | 'First'\r\n  | 'Debugging'\r\n  | 'stdin'\r\n  | 'EOF'\r\n  | 'Stop'\r\n  | 'Executing';\r\nexport class Request {\r\n  constructor(\r\n    public controlEvent: CONTROL_EVENT,\r\n    public sourcecode: string,\r\n    public stdinText?: string,\r\n    public lineNumOfBreakpoint?: number[],\r\n    public progLang?: string,\r\n    public step?: number\r\n  ) {}\r\n}\r\n\r\nexport class Response {\r\n  constructor(\r\n    public output: string,\r\n    public sourcecode: string,\r\n    public debugState: DEBUG_STATE,\r\n    public step: number,\r\n    public errors: SyntaxErrorData[],\r\n    public files: Map<string, ArrayBuffer>,\r\n    public execState?: ExecState,\r\n    public lastState?: ExecState,\r\n    public stepCount?: number,\r\n    public linesShowUp?: any,\r\n    public allVariables?: any,\r\n    public variableShowUp?: any,\r\n    public outputChange?: boolean\r\n  ) {}\r\n}\r\n\r\nclass Server {\r\n  private timer: NodeJS.Timeout | null = null;\r\n  private isExecuting = false;\r\n  private files: Map<string, ArrayBuffer> = new Map();\r\n  private count = 0;\r\n  private interpreter: Interpreter | null = null;\r\n  private stateHistory: ExecState[] = [];\r\n  private outputsHistory: string[] = [];\r\n\r\n  private async dynamicLoadInterpreter(progLang?: string) {\r\n    if (typeof progLang === 'undefined') {\r\n      throw new Error('Selected programming language is invalid.');\r\n    } else if (progLang === 'c_cpp') {\r\n      // prettier-ignore\r\n      const module = await import(/* webpackChunkName: \"CPP14\" */ 'unicoen.ts/dist/interpreter/CPP14/CPP14Interpreter');\r\n      this.interpreter = new module.CPP14Interpreter();\r\n    } else if (progLang === 'java') {\r\n      // prettier-ignore\r\n      const module = await import(/* webpackChunkName: \"Java8\" */ 'unicoen.ts/dist/interpreter/Java8/Java8Interpreter');\r\n      this.interpreter = new module.Java8Interpreter();\r\n    } else if (progLang === 'python') {\r\n      // prettier-ignore\r\n      const module = await import(/* webpackChunkName: \"Python3\" */ 'unicoen.ts/dist/interpreter/Python3/Python3Interpreter');\r\n      this.interpreter = new module.Python3Interpreter();\r\n    }\r\n  }\r\n  private async reset(progLang?: string) {\r\n    this.count = 0;\r\n    await this.dynamicLoadInterpreter(progLang);\r\n    if (this.interpreter === null) {\r\n      throw new Error('Interpreter is not found');\r\n    }\r\n    this.interpreter.setFileList(this.files);\r\n    this.stateHistory = [];\r\n    this.outputsHistory = [];\r\n  }\r\n\r\n  private addFile(file: File) {\r\n    const reader = new FileReader();\r\n    return new Promise((resolve, reject) => {\r\n      reader.onerror = () => {\r\n        reader.abort();\r\n        reject(new DOMException('Problem parsing input file.'));\r\n      };\r\n\r\n      reader.onload = () => {\r\n        if (reader.result instanceof ArrayBuffer) {\r\n          this.files.set(file.name, reader.result);\r\n          resolve(reader.result);\r\n        } else {\r\n          reject(new DOMException('Problem loading input file.'));\r\n        }\r\n      };\r\n\r\n      reader.readAsArrayBuffer(file);\r\n    });\r\n  }\r\n\r\n  public async upload(files: FileList) {\r\n    await Promise.all(Array.from(files).map((file) => this.addFile(file)));\r\n    return this.files;\r\n  }\r\n\r\n  public delete(filename: string) {\r\n    this.files.delete(filename);\r\n    return this.files;\r\n  }\r\n\r\n  public async send(request: Request): Promise<Response> {\r\n    const {\r\n      controlEvent,\r\n      sourcecode,\r\n      stdinText,\r\n      lineNumOfBreakpoint,\r\n      progLang,\r\n      step = 0,\r\n    } = request;\r\n\r\n    switch (controlEvent) {\r\n      case 'Start': {\r\n        return this.Start(sourcecode, progLang);\r\n      }\r\n      case 'Stop': {\r\n        return this.Stop(sourcecode);\r\n      }\r\n      case 'BackAll': {\r\n        return this.BackAll(sourcecode);\r\n      }\r\n      case 'StepBack': {\r\n        return this.StepBack(sourcecode);\r\n      }\r\n      case 'Step': {\r\n        return this.Step(sourcecode, stdinText);\r\n      }\r\n      case 'StepAll': {\r\n        return this.StepAll(sourcecode, lineNumOfBreakpoint);\r\n      }\r\n      case 'JumpTo': {\r\n        return this.JumpTo(sourcecode, step);\r\n      }\r\n      case 'Exec': {\r\n        return this.Exec(sourcecode, progLang, lineNumOfBreakpoint);\r\n      }\r\n      case 'SyntaxCheck': {\r\n        return this.SyntaxCheck(sourcecode, progLang);\r\n      }\r\n    }\r\n  }\r\n\r\n  private async Start(sourcecode: string, progLang?: string) {\r\n    await this.reset(progLang);\r\n    if (this.interpreter === null) {\r\n      throw new Error('interpreter is not found');\r\n    }\r\n    const lineCount = sourcecode.split(/\\r\\n|\\r|\\n/).length;\r\n    const state = this.interpreter.startStepExecution(sourcecode);\r\n    const execState = this.recordExecState(state);\r\n    const stdout = this.interpreter.getStdout();\r\n    const output = this.recordOutputText(stdout);\r\n    const linesShowUp: {\r\n      lineNumber: number;\r\n      steps: number[];\r\n      color: string;\r\n      depth: number[];\r\n      visible: boolean;\r\n    }[] = [];\r\n    const allVariables: { [key: string]: any } = {};\r\n    const variableShowUp: {\r\n      funcName: string;\r\n      name: string;\r\n      steps: number[];\r\n      color: string;\r\n      visible: boolean;\r\n      variable: Variable;\r\n    }[] = [];\r\n    for (let i = 1; i <= lineCount; i++) {\r\n      linesShowUp.push({\r\n        lineNumber: i,\r\n        steps: [],\r\n        color: '',\r\n        depth: [],\r\n        visible: true,\r\n      });\r\n    }\r\n    let ret: Response = {\r\n      execState,\r\n      output,\r\n      sourcecode,\r\n      debugState: 'First',\r\n      step: this.count,\r\n      errors: [],\r\n      files: this.files,\r\n    };\r\n    this.isExecuting = true;\r\n    while (ret.debugState !== 'EOF' && ret.debugState !== 'stdin') {\r\n      const currentExpr = this.stateHistory[this.count].getCurrentExpr();\r\n      const nextExpr = this.stateHistory[this.count].getNextExpr();\r\n      const stacks = this.stateHistory[this.count].getStacks();\r\n      const functionName = stacks[stacks.length - 1].name;\r\n      let depth = 1;\r\n      if (functionName.split('.').length > 1) {\r\n        depth = Number(functionName.split('.')[1]);\r\n      }\r\n      const nCodeRange = nextExpr.codeRange;\r\n      linesShowUp[nCodeRange.begin.y - 1]['steps'].push(this.count + 1);\r\n      linesShowUp[nCodeRange.begin.y - 1]['depth'].push(depth);\r\n\r\n      stacks.forEach((stack) => {\r\n        const stackName = stack.name.split('.')[0];\r\n        if (!(stackName in allVariables)) {\r\n          allVariables[stackName] = {};\r\n        }\r\n        stack.getVariables().forEach((variable) => {\r\n          if (\r\n            inArray(variable.name, Object.keys(allVariables[stackName])) < 0\r\n          ) {\r\n            allVariables[stackName][variable.name] = variableShowUp.length;\r\n            variableShowUp.push({\r\n              funcName: stackName,\r\n              name: variable.name,\r\n              steps: [this.count],\r\n              color: '',\r\n              visible: true,\r\n              variable: variable,\r\n            });\r\n          }\r\n        });\r\n      });\r\n      const currentClassName = currentExpr.constructor.name;\r\n      if (currentExpr instanceof UniBinOp) {\r\n        const res = this.binOp(currentExpr);\r\n        if (res) {\r\n          const stack = stacks[stacks.length - 1];\r\n          const variableName = res;\r\n          variableShowUp[allVariables[stack.name.split('.')[0]][variableName]][\r\n            'steps'\r\n          ].push(this.count);\r\n        }\r\n      }\r\n      let lastExpr = null;\r\n      if (this.count > 0) {\r\n        lastExpr = this.stateHistory[this.count - 1].getNextExpr();\r\n        const nextClassName = lastExpr.constructor.name;\r\n        if (lastExpr instanceof UniBinOp && currentClassName !== 'UniBinOp') {\r\n          const res = this.binOp(lastExpr);\r\n          if (res) {\r\n            const stack = stacks[stacks.length - 1];\r\n            const variableName = res;\r\n            variableShowUp[\r\n              allVariables[stack.name.split('.')[0]][variableName]\r\n            ]['steps'].push(this.count + 1);\r\n          }\r\n        } else if (\r\n          nextClassName === 'UniReturn' &&\r\n          currentClassName === 'UniVariableDec'\r\n        ) {\r\n          const stack = stacks[stacks.length - 1];\r\n          variableShowUp[\r\n            allVariables[stack.name.split('.')[0]][this.uniReturn(currentExpr)]\r\n          ]['steps'].push(this.count);\r\n        } else if (\r\n          nextClassName === 'UniReturn' &&\r\n          currentExpr instanceof UniBinOp\r\n        ) {\r\n          const res = this.returnBinOp(currentExpr);\r\n          if (res) {\r\n            const stack = stacks[stacks.length - 1];\r\n            const variableName = res;\r\n            variableShowUp[\r\n              allVariables[stack.name.split('.')[0]][variableName]\r\n            ]['steps'].push(this.count);\r\n          }\r\n        }\r\n      }\r\n\r\n      ret = this.Step(sourcecode);\r\n    }\r\n\r\n    // console.log(this.stateHistory);\r\n\r\n    const step = this.count + 1;\r\n    this.isExecuting = true;\r\n    const res = this.BackAll(sourcecode);\r\n    res.stepCount = step;\r\n    res.linesShowUp = linesShowUp;\r\n    res.allVariables = allVariables;\r\n    res.variableShowUp = variableShowUp;\r\n    res.outputChange = this.isOutputChange(this.count);\r\n    return res;\r\n  }\r\n\r\n  private binOp(uniBinOp: UniBinOp): string | false {\r\n    const operator = uniBinOp.operator;\r\n    const right: UniBinOp | UniExpr | UniMethodCall = uniBinOp.right;\r\n    if (right instanceof UniMethodCall) {\r\n      if (right.methodName.name !== 'malloc') {\r\n        return false;\r\n      }\r\n    } else if (right instanceof UniBinOp) {\r\n      return this.binOp(right);\r\n    }\r\n\r\n    if (operator !== '=') {\r\n      const left = uniBinOp.left;\r\n\r\n      if (left instanceof UniMethodCall) {\r\n        return false;\r\n      } else if (left instanceof UniBinOp) {\r\n        return this.binOp(left);\r\n      }\r\n    }\r\n    let left = uniBinOp.left;\r\n    if (!left) {\r\n      return false;\r\n    }\r\n    while (!(left instanceof UniIdent)) {\r\n      if (left instanceof UniUnaryOp) {\r\n        left = left.expr;\r\n      } else if (left instanceof UniBinOp) {\r\n        left = left.left;\r\n      }\r\n    }\r\n    return left.name;\r\n  }\r\n\r\n  private uniReturn(expr: any) {\r\n    return expr.variables[0].name;\r\n  }\r\n  private returnBinOp(uniBinOp: UniBinOp) {\r\n    const operator = uniBinOp.operator;\r\n    if (operator === '=') {\r\n      const left: any = uniBinOp.left;\r\n      return left.name;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  private Stop(sourcecode: string) {\r\n    if (this.timer !== null) {\r\n      clearTimeout(this.timer);\r\n    }\r\n    this.interpreter = null;\r\n    const ret: Response = {\r\n      sourcecode,\r\n      execState: undefined,\r\n      debugState: 'Stop',\r\n      output: '',\r\n      step: this.count,\r\n      errors: [],\r\n      files: this.files,\r\n    };\r\n    return ret;\r\n  }\r\n\r\n  private BackAll(sourcecode: string) {\r\n    this.count = 0;\r\n    const execState = this.stateHistory[this.count];\r\n    const output = this.outputsHistory[this.count];\r\n    const ret: Response = {\r\n      execState,\r\n      output,\r\n      sourcecode,\r\n      debugState: 'First',\r\n      step: this.count,\r\n      errors: [],\r\n      files: this.files,\r\n    };\r\n    return ret;\r\n  }\r\n\r\n  private StepBack(sourcecode: string) {\r\n    if (1 <= this.count) {\r\n      this.count -= 1;\r\n    }\r\n    const execState = this.stateHistory[this.count];\r\n    let lastState = undefined;\r\n    if (this.count > 0) {\r\n      lastState = this.stateHistory[this.count - 1];\r\n    }\r\n    const output = this.outputsHistory[this.count];\r\n    const ret: Response = {\r\n      execState,\r\n      lastState: lastState,\r\n      output,\r\n      sourcecode,\r\n      debugState: 'Debugging',\r\n      step: this.count,\r\n      errors: [],\r\n      files: this.files,\r\n    };\r\n    return ret;\r\n  }\r\n\r\n  private Step(sourcecode: string, stdinText?: string) {\r\n    ++this.count;\r\n    if (this.count < this.stateHistory.length) {\r\n      const execState = this.stateHistory[this.count];\r\n      let lastState = undefined;\r\n      if (this.count > 0) {\r\n        lastState = this.stateHistory[this.count - 1];\r\n      }\r\n      const output = this.outputsHistory[this.count];\r\n      const ret: Response = {\r\n        execState,\r\n        lastState: lastState,\r\n        output,\r\n        sourcecode,\r\n        debugState: 'Debugging',\r\n        step: this.count,\r\n        errors: [],\r\n        files: this.files,\r\n        outputChange: this.isOutputChange(this.count),\r\n      };\r\n      return ret;\r\n    }\r\n    if (this.isExecuting) {\r\n      if (this.interpreter === null) {\r\n        throw new Error('engine is not found');\r\n      }\r\n      if (this.interpreter.getIsWaitingForStdin()) {\r\n        if (stdinText !== undefined) {\r\n          this.interpreter.stdin(stdinText);\r\n        }\r\n        //  console.log(`stdin:${stdinText}`);\r\n      }\r\n      const state = this.interpreter.stepExecute();\r\n      // let maxSkip = 10;\r\n      // while (state.getCurrentExpr().codeRange === null && 0 < --maxSkip) {\r\n      //   state = this.engine.stepExecute();\r\n      // }\r\n      const execState = this.recordExecState(state);\r\n      const stdout = this.interpreter.getStdout();\r\n      //  console.log(`stdout:${stdout}`);\r\n      const output = this.recordOutputText(stdout);\r\n      //  console.log(`output:${output}`);\r\n      // let stateText = `Step:${this.count} | Value:${execState.getCurrentValue()}`;\r\n      let debugState: DEBUG_STATE = 'Debugging';\r\n      if (this.interpreter.getIsWaitingForStdin()) {\r\n        debugState = 'stdin';\r\n      } else if (!this.interpreter.isStepExecutionRunning()) {\r\n        debugState = 'EOF';\r\n        this.isExecuting = false;\r\n      }\r\n      const ret: Response = {\r\n        execState,\r\n        lastState: this.stateHistory[this.stateHistory.length - 2],\r\n        output,\r\n        sourcecode,\r\n        debugState,\r\n        step: this.count,\r\n        errors: [],\r\n        files: this.files,\r\n        outputChange: this.isOutputChange(this.count),\r\n      };\r\n      return ret;\r\n    }\r\n    this.count = this.stateHistory.length - 1;\r\n    const output = this.outputsHistory[this.count];\r\n    const ret: Response = {\r\n      output,\r\n      sourcecode,\r\n      execState: this.getLastHistory(),\r\n      debugState: 'EOF',\r\n      step: this.count,\r\n      errors: [],\r\n      files: this.files,\r\n      outputChange: this.isOutputChange(this.count),\r\n    };\r\n    return ret;\r\n  }\r\n\r\n  private StepAll(sourcecode: string, lineNumOfBreakpoint?: number[]) {\r\n    const currentCount = this.count;\r\n    const loop = () => {\r\n      const ret: Response = this.Step(sourcecode);\r\n      if (ret.debugState === 'EOF') {\r\n        signal('EOF', ret);\r\n        return;\r\n      } else if (ret.debugState === 'stdin') {\r\n        signal('stdin', ret);\r\n        return;\r\n      } else if (typeof lineNumOfBreakpoint !== 'undefined') {\r\n        if (typeof ret.execState !== 'undefined') {\r\n          const nextExpr = ret.execState.getNextExpr();\r\n          const { codeRange } = nextExpr;\r\n          if (codeRange) {\r\n            if (lineNumOfBreakpoint.includes(codeRange.begin.y - 1)) {\r\n              signal('Breakpoint', ret);\r\n              return;\r\n            }\r\n          }\r\n        }\r\n      }\r\n      this.timer = global.setTimeout(loop.bind(this), 1);\r\n    };\r\n    loop();\r\n    const execState = this.stateHistory[currentCount];\r\n    const output = this.outputsHistory[currentCount];\r\n    const debugState: DEBUG_STATE = 'Executing';\r\n    return {\r\n      execState,\r\n      output,\r\n      sourcecode,\r\n      debugState,\r\n      step: currentCount,\r\n      errors: [],\r\n      files: this.files,\r\n    };\r\n  }\r\n\r\n  private JumpTo(sourcecode: string, step: number) {\r\n    this.count = step;\r\n    const execState = this.stateHistory[this.count];\r\n    let lastState = undefined;\r\n    if (this.count > 0) {\r\n      lastState = this.stateHistory[this.count - 1];\r\n    }\r\n    const output = this.outputsHistory[this.count];\r\n    const ret: Response = {\r\n      execState,\r\n      lastState: lastState,\r\n      output,\r\n      sourcecode,\r\n      debugState: 'Debugging',\r\n      step: this.count,\r\n      errors: [],\r\n      files: this.files,\r\n    };\r\n    return ret;\r\n  }\r\n\r\n  private async Exec(\r\n    sourcecode: string,\r\n    progLang?: string,\r\n    lineNumOfBreakpoint?: number[]\r\n  ) {\r\n    await this.Start(sourcecode, progLang);\r\n    return this.StepAll(sourcecode, lineNumOfBreakpoint);\r\n  }\r\n\r\n  private async SyntaxCheck(code: string, progLang?: string) {\r\n    await this.dynamicLoadInterpreter(progLang);\r\n    if (this.interpreter === null) {\r\n      throw new Error('Interpreter is not found');\r\n    }\r\n    const errors: SyntaxErrorData[] = this.interpreter.checkSyntaxError(code);\r\n    const ret: Response = {\r\n      errors,\r\n      sourcecode: code,\r\n      execState: undefined,\r\n      debugState: 'Stop',\r\n      output: '',\r\n      step: this.count,\r\n      files: this.files,\r\n    };\r\n    return ret;\r\n  }\r\n\r\n  private recordOutputText(output: string) {\r\n    this.outputsHistory.push(output);\r\n    return output;\r\n  }\r\n\r\n  private recordExecState(execState: ExecState) {\r\n    this.stateHistory.push(execState);\r\n    return execState;\r\n  }\r\n\r\n  private getLastHistory() {\r\n    return this.stateHistory[this.stateHistory.length - 1];\r\n  }\r\n\r\n  private isOutputChange(step: number) {\r\n    if (step === 0) return false;\r\n    return (\r\n      this.outputsHistory[step].length > this.outputsHistory[step - 1].length\r\n    );\r\n  }\r\n}\r\n\r\nexport const server = new Server();\r\n","import React from 'react';\r\nimport './style.scss';\r\n\r\ninterface PanelHeaderProps {\r\n    title: string;\r\n}\r\n\r\nfunction PanelHeader({title}: PanelHeaderProps) {\r\n  return (\r\n      <div className='panel-header'>\r\n        <div className='text-title'>{title}</div>\r\n      </div>\r\n  );\r\n}\r\n\r\nexport default PanelHeader;\r\n","// tslint:disable:max-line-length\nexport default {\n  howToUse: '',\n  close: '',\n  debugStart: '',\n  debugStop: '',\n  debugBackAll: '',\n  debugStepBack: '1',\n  debugStep: '1',\n  debugStepAll: '',\n  changeThemedark: '',\n  changeThemelight: '',\n  zoomOut: '',\n  zoomIn: '',\n  zoomReset: '',\n  howToText: [\n    '',\n    '()',\n  ],\n  uploadFile: '',\n  warning: '!',\n  editInDebug: `\n\n`,\n  continueDebug: '',\n  restart: '',\n  rememberCommand: '',\n  sourceCodeCcpp: String.raw`#include<stdio.h>\nint recursiveToThree(int n){\n  printf(\"%d th\\n\", n + 1);\n  if(n < 3){\n    int r = recursiveToThree(n + 1);\n    n = r;\n  }\n  return n;\n}\nint main(){\n  int n = 0;//\n\n  n = recursiveToThree(0);//\n\n  int arr[5] = {1, 2, 3};//\n\n  int* ptr = &arr[2];//\n  *ptr = 5;\n\n  //\n  int* d_arry = malloc(sizeof(int) * 3);\n\n  //\n  int* pd_arr[2];\n  pd_arr[0] = malloc(sizeof(int) * 2);\n  pd_arr[1] = malloc(sizeof(int) * 2);\n\n  free(pd_arr[0]);//\n\n  printf(\"Hello,world!\\n\");//\n\n\n  return 0;\n}`,\n  sourceCodeJava: String.raw`import java.util.*;\npublic class Main {\n  public static void main(String[] args) {\n    Scanner sc = new Scanner(System.in);\n    while (true) {\n      int n = sc.nextInt();\n      int r = sc.nextInt();\n      if (n == 0) {\n        break;\n      }\n      int[] a = new int[n];\n      int[] b = new int[n];\n      for (int i = 0; i < n; i++) {\n        a[i] = n - i;\n      }\n      for (int i = 0; i < r; i++) {\n        int p = sc.nextInt();\n        int c = sc.nextInt();\n        p--;\n        for (int j = 0; j < c; j++) {\n          b[j] = a[p + j];\n        }\n        for (int j = 0; j < p; j++) {\n          b[c + j] = a[j];\n        }\n        for (int j = 0; j < p + c; j++) {\n          a[j] = b[j];\n        }\n      }\n      System.out.println(a[0]);\n    }\n  }\n}`,\n  sourceCodePython: String.raw`while True:\n  n, r = map(int, input().split())\n  if n == 0:\n    break\n  a = [0] * n\n  b = [0] * n\n  for i in range(n):\n    a[i] = b[i] = n - i\n  for i in range(r):\n    p, c = map(int, input().split())\n    p = p - 1\n    for j in range(c):\n      b[j] = a[p + j]\n    for j in range(p):\n      b[c + j] = a[j]\n    for j in range(p + c):\n      a[j] = b[j]\n  print(a[0])\n`,\n};\n","// tslint:disable:max-line-length\r\nexport default {\r\n  howToUse: 'How to use',\r\n  close: 'Close',\r\n  debugStart: 'restart step execution',\r\n  debugStop: 'stop execution',\r\n  debugBackAll: 'go backward for all steps',\r\n  debugStepBack: 'step backward',\r\n  debugStep: 'step forward',\r\n  debugStepAll: 'execute all step',\r\n  changeThemedark: 'change to dark theme',\r\n  changeThemelight: 'change to light theme',\r\n  zoomOut: 'change the font size to smaller.',\r\n  zoomIn: 'change the font size to larger.',\r\n  zoomReset: 'reset the font size',\r\n  howToText: [\r\n    'PVC.js has five GUI components:',\r\n    '(1) editor, (2) execution controller, buttons, (3) I/O window, (4) canvas for visualization, and (5) file upload form.',\r\n    'Users can write source code in the editor. Clicking on the execution control buttons initiates the step execution.',\r\n    'The I/O window shows the content of the standard output written by the program (e.g., printf) and accepts standard input (e.g., scanf).',\r\n    \"Canvas shows the program's execution status using tables and figures.\",\r\n    'PVC.js adaptively changes its layout to correspond with the size of the browser window.',\r\n  ],\r\n  uploadFile: 'The uploaded file will be displayed here.',\r\n  warning: 'Warning!',\r\n  editInDebug: `The source code being executed has been edited.\r\nProgram behavior is not affected by changing code. \r\nHowever, the highlight of the code may be out of place.`,\r\n  continueDebug: 'Continue',\r\n  restart: 'Restart',\r\n  rememberCommand: 'Remember this choice',\r\n//   sourceCodeCcpp: String.raw`#include<stdio.h>\r\n// int recursiveToThree(int n){\r\n//   printf(\"%d th\\n\", n + 1);\r\n//   if(n < 3){\r\n//       int r = recursiveToThree(n + 1);\r\n//       n = r;\r\n//   }\r\n//   return n;\r\n// }\r\n\r\n// static int a = 1;\r\n// int b = 2;\r\n\r\n// int main(){\r\n//   int n = 0;//variable declaration\r\n\r\n//   n = recursiveToThree(0);//recursive function\r\n\r\n//   int arr[5] = {1, 2, 3};//array variable\r\n\r\n//   int* ptr = &arr[2];//pointer variable\r\n//   *ptr = 5;\r\n\r\n//   //dynamic memory allocation\r\n//   int* d_arry = malloc(sizeof(int) * 3);\r\n\r\n//   //two-dimensional dynamic array\r\n//   int* pd_arr[2];\r\n//   pd_arr[0] = malloc(sizeof(int) * 2);\r\n//   pd_arr[1] = malloc(sizeof(int) * 2);\r\n\r\n//   printf(\"Hello,world!\\n\");//standard output\r\n\r\n//   free(pd_arr[0]);//memory leak\r\n\r\n//   return 0;\r\n// }`\r\nsourceCodeCcpp: String.raw`#include<stdio.h>\r\n\r\n/*print Fahrenheit-Celsius table\r\n    for fahr = 0, 20, ..., 300 */\r\n\r\nint main() {\r\n  int fahr, celsius;\r\n  int lower, upper, step;\r\n  lower = 0;\r\n  upper = 300;\r\n  step = 20;\r\n  \r\n  fahr = lower;\r\n  while (fahr <= upper) {\r\n    celsius = 5 * (fahr-32) / 9;\r\n    printf(\"%d\\t%d\\n\", fahr, celsius);\r\n    fahr = fahr + step;\r\n  }\r\n}\r\n`\r\n,\r\n  sourceCodeJava: String.raw`import java.util.*;\r\npublic class Main {\r\n  public static void main(String[] args) {\r\n    Scanner sc = new Scanner(System.in);\r\n    while (true) {\r\n      int n = sc.nextInt();\r\n      int r = sc.nextInt();\r\n      if (n == 0) {\r\n        break;\r\n      }\r\n      int[] a = new int[n];\r\n      int[] b = new int[n];\r\n      for (int i = 0; i < n; i++) {\r\n        a[i] = n - i;\r\n      }\r\n      for (int i = 0; i < r; i++) {\r\n        int p = sc.nextInt();\r\n        int c = sc.nextInt();\r\n        p--;\r\n        for (int j = 0; j < c; j++) {\r\n          b[j] = a[p + j];\r\n        }\r\n        for (int j = 0; j < p; j++) {\r\n          b[c + j] = a[j];\r\n        }\r\n        for (int j = 0; j < p + c; j++) {\r\n          a[j] = b[j];\r\n        }\r\n      }\r\n      System.out.println(a[0]);\r\n    }\r\n  }\r\n}`,\r\n  sourceCodePython: String.raw`while True:\r\n  n, r = map(int, input().split())\r\n  if n == 0:\r\n    break\r\n  a = [0] * n\r\n  b = [0] * n\r\n  for i in range(n):\r\n    a[i] = b[i] = n - i\r\n  for i in range(r):\r\n    p, c = map(int, input().split())\r\n    p = p - 1\r\n    for j in range(c):\r\n      b[j] = a[p + j]\r\n    for j in range(p):\r\n      b[c + j] = a[j]\r\n    for j in range(p + c):\r\n      a[j] = b[j]\r\n  print(a[0])\r\n`,\r\n};\r\n","import ja from './ja';\nimport en from './en';\nconst translate = (lang: string, key: string) => {\n  if (lang === 'ja') {\n    return (ja as any)[key];\n  }\n  return (en as any)[key];\n};\nexport default translate;\n","const ADD_ITEM = 'ADD_ITEM';\r\nconst REMOVE_ITEM = 'REMOVE_ITEM';\r\nconst ADD_VAR = 'ADD_VAR';\r\nconst REMOVE_VAR = 'REMOVE_VAR';\r\n\r\nconst initState = {\r\n  // line numbers of the highlight statments: color\r\n  statements: {},\r\n  variables: {},\r\n}\r\n\r\nconst palette = ['#4d7cfe', '#f35c9b', '#feb74b', '#ca78ff'];\r\nconst variablesPalette = ['#5E8B7E', '#FFC288', '#A19882'];\r\n\r\nlet id = 0;\r\nconst existColor = new Set();\r\n\r\nconst getHashColor = (index) => {\r\n  const color = palette[index % palette.length];\r\n  if (existColor.has(color)) {\r\n    return getHashColor(index + 1);\r\n  } else {\r\n    existColor.add(color)\r\n    return color;\r\n  }\r\n};\r\n\r\nexport const getColor = () => {\r\n  if (existColor.size === palette.length) return 'DISABLE';\r\n  return getHashColor(id++);\r\n};\r\n\r\nexport const addHighlightStatement = (lineNumber, color) => {\r\n  return {\r\n    type: ADD_ITEM,\r\n    data: { [lineNumber]: color }\r\n  }\r\n}\r\n\r\nexport const removeHighlightStatement = (lineNumber) => {\r\n  return {\r\n    type: REMOVE_ITEM,\r\n    data: lineNumber\r\n  }\r\n}\r\n\r\nexport const addVariable = (variable) => {\r\n  return {\r\n    type: ADD_VAR,\r\n    data: variable\r\n  }\r\n}\r\n\r\nconst reducer = (state = initState, action) => {\r\n  switch (action.type) {\r\n    case ADD_ITEM:\r\n      return { ...state, statements: { ...state.statements, ...action.data } }\r\n    case REMOVE_ITEM:\r\n      const { [action.data]: old, ...rest } = state.statements;\r\n      console.log(old)\r\n      existColor.delete(old);\r\n      return { ...state, statements: rest }\r\n    case ADD_VAR:\r\n      return {\r\n        ...state, variables: {\r\n          ...state.variables,\r\n          ...{ [action.data.join('-')]: variablesPalette[Object.keys(state.variables).length % variablesPalette.length] }\r\n        }\r\n      }\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport default reducer;","import * as React from 'react';\r\nimport Alert from 'react-bootstrap/lib/Alert';\r\nimport Button from 'react-bootstrap/lib/Button';\r\nimport Modal from 'react-bootstrap/lib/Modal';\r\nimport Checkbox from 'react-bootstrap/lib/Checkbox';\r\n// tslint:disable-next-line:import-name\r\nimport AceEditor from 'react-ace';\r\n\r\nimport 'ace-builds/src-min-noconflict/mode-c_cpp';\r\nimport 'ace-builds/src-min-noconflict/snippets/c_cpp';\r\nimport 'ace-builds/src-min-noconflict/theme-textmate';\r\nimport 'ace-builds/src-min-noconflict/theme-monokai';\r\nimport 'ace-builds/src-min-noconflict/ext-language_tools';\r\nimport * as d3 from 'd3';\r\n\r\nimport './editor.scss';\r\nimport { signal, slot, remove } from '../emitter';\r\nimport {\r\n  Request,\r\n  CONTROL_EVENT,\r\n  server,\r\n  Response,\r\n  DEBUG_STATE,\r\n} from '../server';\r\nimport translate from '../../locales/translate';\r\nimport { ExecState } from 'unicoen.ts/dist/interpreter/Engine/ExecState';\r\nimport { LangProps, ProgLangProps, Theme } from '../Props';\r\nimport { SyntaxErrorData } from 'unicoen.ts/dist/interpreter/mapper/SyntaxErrorData';\r\nimport { connect } from 'react-redux'\r\nimport { addHighlightStatement, removeHighlightStatement } from '../../store';\r\nimport {getColor} from '../../store/index'\r\nimport { message } from 'antd';\r\n\r\ntype Props = LangProps & ProgLangProps & {\r\n  addHighlightStatement: Function,\r\n  removeHighlightStatement: Function\r\n};\r\ninterface State {\r\n  fontSize: number;\r\n  showAlert: boolean;\r\n  theme: Theme;\r\n}\r\n\r\ninterface TextRectangle {\r\n  left: number;\r\n  top: number;\r\n  width: number;\r\n  height: number;\r\n}\r\n\r\ninterface GutterMousedownEventTarget\r\n  extends React.BaseHTMLAttributes<HTMLElement> {\r\n  getBoundingClientRect: () => TextRectangle;\r\n}\r\ninterface GutterMousedownEvent extends React.MouseEvent {\r\n  domEvent: React.MouseEvent<GutterMousedownEventTarget>;\r\n  editor: AceAjax.Editor;\r\n  getDocumentPosition: () => AceAjax.Position;\r\n  stop: () => void;\r\n}\r\n\r\nclass Editor extends React.Component<Props, State> {\r\n  private sentSourcecode: string;\r\n  private preventedCommand: CONTROL_EVENT = 'Stop';\r\n  private controlEvent: CONTROL_EVENT = 'Stop';\r\n  private sourcecode: string;\r\n  private ace: any = null;\r\n  private editorRef = React.createRef<any>();\r\n  private lineNumOfBreakpoint: number[] = [];\r\n  private isDebugging = false;\r\n  private checkbox: HTMLInputElement | null = null;\r\n  private noAlert = false;\r\n  private highlightIds: number[] = [];\r\n  constructor(props: Props) {\r\n    super(props);\r\n    this.state = {\r\n      fontSize: 14,\r\n      showAlert: false,\r\n      theme: 'light',\r\n    };\r\n    const { lang, progLang } = props;\r\n    this.sourcecode = translate(lang, this.sourceCodeKey(progLang));\r\n    this.sentSourcecode = '';\r\n\r\n    this.hideAlert = this.hideAlert.bind(this);\r\n    this.setHighlightOnCode = this.setHighlightOnCode.bind(this);\r\n  }\r\n\r\n  componentDidMount() {\r\n    const progLang = this.props.progLang;\r\n    slot('debug', (controlEvent: CONTROL_EVENT, stdinText?: string) => {\r\n      this.send(controlEvent, stdinText);\r\n      if (controlEvent === 'StepBack' || controlEvent === 'BackAll') {\r\n        sessionStorage.setItem('exec', 'step');\r\n      } else {\r\n        sessionStorage.setItem('exec', 'debug');\r\n      }\r\n    });\r\n    slot('jumpTo', (step: number) => {\r\n      const request: Request = {\r\n        sourcecode: this.sourcecode,\r\n        controlEvent: 'JumpTo',\r\n        progLang,\r\n        step: step,\r\n      };\r\n      server\r\n        .send(request)\r\n        .then((response: Response) => {\r\n          this.recieve(response);\r\n        })\r\n        .catch((e) => {\r\n          alert('constructor: ' + e);\r\n        });\r\n      sessionStorage.setItem('exec', 'step');\r\n    });\r\n    slot('EOF', (response: Response) => {\r\n      this.recieve(response);\r\n    });\r\n    slot('stdin', (response: Response) => {\r\n      this.recieve(response);\r\n    });\r\n    slot('Breakpoint', (response: Response) => {\r\n      this.recieve(response);\r\n    });\r\n    slot('zoom', (command: string) => {\r\n      if (command === 'In') {\r\n        this.setState({ fontSize: this.state.fontSize + 1 });\r\n      } else if (command === 'Out') {\r\n        this.setState({ fontSize: Math.max(this.state.fontSize - 1, 10) });\r\n      } else if (command === 'Reset') {\r\n        this.setState({ fontSize: 14 });\r\n      }\r\n    });\r\n    slot('changeTheme', async (theme: Theme) => {\r\n      this.setState({ theme });\r\n    });\r\n\r\n    // Enable breakpoint\r\n    const editor: AceAjax.Editor = this.editorRef.current.editor;\r\n    editor.on('keydown', (e: any) => {\r\n      // console.log(e);\r\n    });\r\n    editor.on('guttermousedown', (e: GutterMousedownEvent) => {\r\n      //  mousedown\r\n      const AceRange = this.ace.acequire('ace/range').Range;\r\n      const target: GutterMousedownEventTarget = e.domEvent.currentTarget;\r\n      if (\r\n        typeof target.className !== 'undefined' &&\r\n        target.className.indexOf('ace_gutter') === -1\r\n      ) {\r\n        return;\r\n      }\r\n      if (!editor.isFocused()) {\r\n        return;\r\n      }\r\n      if (e.clientX > 25 + target.getBoundingClientRect().left) return;\r\n\r\n      const row: number = e.getDocumentPosition().row;\r\n\r\n      const session: AceAjax.IEditSession = e.editor.getSession();\r\n      if (this.lineNumOfBreakpoint.includes(row)) {\r\n        session.clearBreakpoint(row);\r\n        //signal('cancelStatementHighlight', row);\r\n        //const line = d3.selectAll('.ace_line').filter((d, i) => i === row);\r\n        //line.classed('highlight' + row, false);\r\n        this.lineNumOfBreakpoint = this.lineNumOfBreakpoint.filter(\r\n          (n) => n !== row\r\n        );\r\n\r\n        const line = d3.selectAll('.ace_gutter-cell').filter((d, i) => i === row)\r\n        .style('background', '#f3f7f9')\r\n        .style('border-left', 'none')\r\n\r\n        console.log(row)\r\n        this.props.removeHighlightStatement(row);\r\n      } else {\r\n        const color = getColor();\r\n        if(color === 'DISABLE') {\r\n          message.warning('')\r\n        } else {\r\n          session.setBreakpoint(row, 'ace_breakpoint');\r\n          this.lineNumOfBreakpoint.push(row);\r\n          const line = d3.selectAll('.ace_gutter-cell').filter((d, i) => i === row)\r\n            .style('background', color+'33')\r\n            .style('border-left', '3px solid ' + color)\r\n          // line.classed('highlight' + row, true);\r\n          //signal('statementHighlight', row);\r\n          // console.log(row)\r\n          this.props.addHighlightStatement(row, color)\r\n        }\r\n\r\n      }\r\n      e.stop();\r\n    });\r\n  }\r\n\r\n  // componentDidUpdate() {\r\n    // d3.selectAll('.ace_line')\r\n    //   // .filter((d, i) => inArray(i, this.lineNumOfBreakpoint) >= 0)\r\n    //   .attr('class', (d, i) => {\r\n    //     return `ace_line highlight${i}`;\r\n    //   });\r\n  // }\r\n\r\n  componentWillUnmount() {\r\n    remove('debug');\r\n    remove('jumpTo');\r\n    remove('EOF');\r\n    remove('stdin');\r\n    remove('Breakpoint');\r\n    remove('zoom');\r\n    remove('changeTheme');\r\n  }\r\n\r\n  sourceCodeKey = (prog: string) =>\r\n    'sourceCode' +\r\n    prog.replace(/_/g, '').replace(/^[a-z]/g, (char) => char.toUpperCase());\r\n\r\n  // UNSAFE_componentWillReceiveProps(nextProps: Props) {\r\n  //   const { lang, progLang } = this.props;\r\n  //   const nextLang = nextProps.lang;\r\n  //   const nextProgLang = nextProps.progLang;\r\n\r\n  //   if (nextLang !== lang) {\r\n  //     if (this.sourcecode === translate(lang, this.sourceCodeKey(progLang))) {\r\n  //       this.sourcecode = translate(nextLang, this.sourceCodeKey(nextProgLang));\r\n  //     }\r\n  //   } else if (nextProgLang !== progLang) {\r\n  //     this.sourcecode = translate(nextLang, this.sourceCodeKey(nextProgLang));\r\n  //   }\r\n  // }\r\n\r\n  send(controlEvent: CONTROL_EVENT, stdinText?: string) {\r\n    const sourcecode = this.sourcecode;\r\n    const lineNumOfBreakpoint = this.lineNumOfBreakpoint;\r\n    const progLang = this.props.progLang;\r\n    const request: Request = {\r\n      sourcecode,\r\n      controlEvent,\r\n      stdinText,\r\n      lineNumOfBreakpoint,\r\n      progLang,\r\n    };\r\n    this.controlEvent = controlEvent;\r\n    if (controlEvent === 'SyntaxCheck') {\r\n      server\r\n        .send(request)\r\n        .then((response: Response) => {\r\n          const { errors } = response;\r\n          this.setSyntaxError(errors);\r\n        })\r\n        .catch((e) => {\r\n          alert('SyntaxCheck: ' + e);\r\n        });\r\n    } else if (\r\n      !this.noAlert &&\r\n      this.isDebugging &&\r\n      (controlEvent === 'BackAll' ||\r\n        controlEvent === 'StepBack' ||\r\n        controlEvent === 'Step' ||\r\n        controlEvent === 'StepAll') &&\r\n      sourcecode !== this.sentSourcecode\r\n    ) {\r\n      this.preventedCommand = controlEvent;\r\n      this.setState({ showAlert: true });\r\n    } else {\r\n      this.setState({ showAlert: false });\r\n      server\r\n        .send(request)\r\n        .then((response: Response) => {\r\n          this.recieve(response);\r\n        })\r\n        .catch((e) => {\r\n          alert('Other controlEvent' + e);\r\n        });\r\n    }\r\n  }\r\n\r\n  recieve(response: Response) {\r\n    try {\r\n      const {\r\n        debugState,\r\n        execState,\r\n        output,\r\n        step,\r\n        sourcecode,\r\n        files,\r\n        lastState,\r\n        stepCount,\r\n        linesShowUp,\r\n        allVariables,\r\n        variableShowUp,\r\n        outputChange,\r\n      } = response;\r\n      this.isDebugging = debugState !== 'Stop';\r\n      this.sentSourcecode = sourcecode;\r\n      if (debugState === 'Executing') {\r\n        return;\r\n      }\r\n      if (debugState === 'First') {\r\n        signal('init', stepCount, linesShowUp, allVariables, variableShowUp);\r\n      }\r\n      if (this.controlEvent !== 'JumpTo') {\r\n        signal('changeStep', step);\r\n      }\r\n      signal('changeState', debugState, step);\r\n      signal('changeOutput', output, outputChange);\r\n      signal('draw', execState, lastState);\r\n      signal('files', files);\r\n      this.setHighlightOnCode(debugState, execState);\r\n    } catch (e) {\r\n      alert('recieve: ' + e);\r\n    }\r\n  }\r\n\r\n  setHighlightOnCode(debugState: DEBUG_STATE, execState?: ExecState) {\r\n    if (debugState === 'Stop') {\r\n      return;\r\n    }\r\n    if (typeof execState === 'undefined') {\r\n      return;\r\n    }\r\n    const codeRange = execState.getNextExpr().codeRange;\r\n    const AceRange = this.ace.acequire('ace/range').Range;\r\n    const editor: AceAjax.Editor = this.editorRef.current.editor;\r\n    if (codeRange) {\r\n      const range: AceAjax.Range = new AceRange(\r\n        codeRange.begin.y - 1,\r\n        codeRange.begin.x,\r\n        codeRange.end.y - 1,\r\n        codeRange.end.x\r\n      );\r\n      editor.resize(true);\r\n      // tslint:disable-next-line:no-empty\r\n      editor.scrollToLine(codeRange.begin.y, true, true, () => {});\r\n      if (debugState === 'EOF') {\r\n        editor.getSelection().setSelectionRange(new AceRange(-1, 0, -1, 1));\r\n      } else {\r\n        editor.getSelection().setSelectionRange(range);\r\n      }\r\n    }\r\n  }\r\n\r\n  setSyntaxError(errors: SyntaxErrorData[]) {\r\n    const editor: AceAjax.Editor = this.editorRef.current.editor;\r\n    const annotations = errors.map((error: SyntaxErrorData) => {\r\n      return {\r\n        row: error.line - 1,\r\n        column: error.charPositionInLine - 1,\r\n        text: error.getMsg(),\r\n        type: 'error',\r\n      };\r\n    });\r\n    const session: AceAjax.IEditSession = editor.getSession();\r\n    session.setAnnotations(annotations);\r\n    for (const highlightId of this.highlightIds) {\r\n      session.removeMarker(highlightId);\r\n    }\r\n    this.highlightIds = [];\r\n    for (const annotation of annotations) {\r\n      const range = (session as any).highlightLines(\r\n        annotation.row,\r\n        annotation.row,\r\n        'error_line'\r\n      );\r\n      this.highlightIds.push(range.id);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <React.Fragment>\r\n        {this.state.showAlert ? this.renderAlert() : null} {this.renderEditor()}\r\n      </React.Fragment>\r\n    );\r\n  }\r\n\r\n  renderEditor() {\r\n    const mode = this.props.progLang;\r\n    const { fontSize, theme } = this.state;\r\n    return (\r\n      <AceEditor\r\n        ref={this.editorRef}\r\n        mode={mode}\r\n        theme=\"textmate\"\r\n        value={this.sourcecode}\r\n        name=\"sourcecode\"\r\n        fontSize={fontSize}\r\n        tabSize={2}\r\n        editorProps={{\r\n          $blockScrolling: Infinity,\r\n        }}\r\n        setOptions={{\r\n          enableBasicAutocompletion: true,\r\n          enableLiveAutocompletion: true,\r\n          showLineNumbers: true,\r\n          readOnly: false,\r\n        }}\r\n        style={{ height: '100%', width: '100%' }}\r\n        className=\"editorMain\"\r\n        onChange={(text: string) => {\r\n          this.sourcecode = text;\r\n          const delaySyntaxCheck = (code: string) => {\r\n            if (code === this.sourcecode) {\r\n              signal('debug', 'SyntaxCheck');\r\n            }\r\n          };\r\n          setTimeout(() => delaySyntaxCheck(text), 1000);\r\n        }}\r\n        onBeforeLoad={(ace) => (this.ace = ace)}\r\n      />\r\n    );\r\n  }\r\n\r\n  hideAlert() {\r\n    this.setState({ showAlert: false });\r\n  }\r\n\r\n  renderAlert() {\r\n    const { lang } = this.props;\r\n    const warning = translate(lang, 'warning');\r\n    const editInDebug = translate(lang, 'editInDebug');\r\n    const continueDebug = translate(lang, 'continueDebug');\r\n    const restart = translate(lang, 'restart');\r\n    const rememberCommand = translate(lang, 'rememberCommand');\r\n    return (\r\n      <Modal.Dialog\r\n        className=\"modal-container\"\r\n        aria-labelledby=\"ModalHeader\"\r\n        // animation={true}\r\n        tabIndex={-1}\r\n        role=\"dialog\"\r\n      >\r\n        <Modal.Header closeButton>\r\n          <Modal.Title>{warning}</Modal.Title>\r\n        </Modal.Header>\r\n        <Alert bsStyle=\"danger\">\r\n          <p>{editInDebug}</p>\r\n        </Alert>\r\n        <Modal.Footer>\r\n          <Button\r\n            bsStyle=\"danger\"\r\n            onClick={() => {\r\n              this.isDebugging = false;\r\n              if (this.checkbox !== null) {\r\n                this.noAlert = this.checkbox.checked;\r\n              }\r\n              signal('debug', this.preventedCommand);\r\n            }}\r\n          >\r\n            {continueDebug}\r\n          </Button>\r\n          <Button\r\n            onClick={() => {\r\n              this.isDebugging = false;\r\n              if (this.checkbox !== null) {\r\n                this.noAlert = this.checkbox.checked;\r\n              }\r\n              signal('debug', 'Start');\r\n            }}\r\n          >\r\n            {restart}\r\n          </Button>\r\n          <Checkbox\r\n            validationState=\"warning\"\r\n            inputRef={(ref) => (this.checkbox = ref)}\r\n          >\r\n            {rememberCommand}\r\n          </Checkbox>\r\n        </Modal.Footer>\r\n      </Modal.Dialog>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = {\r\n  addHighlightStatement: addHighlightStatement,\r\n  removeHighlightStatement: removeHighlightStatement\r\n}\r\n\r\nexport default (connect(null, mapDispatchToProps) as any)(Editor)","import React from 'react';\r\nimport './style.scss';\r\nimport PanelHeader from '../../components/panelHeader/PanelHeader';\r\nimport Editor from '../../components/editor/Editor';\r\n\r\nfunction EditorPanel() {\r\n  return (\r\n    <div id='EditorPanel' className='panel'>\r\n      <PanelHeader title='Source Editor' />\r\n      <div className='editor-area'>\r\n        <Editor lang='en' progLang='c_cpp'/>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default EditorPanel;\r\n","import * as React from 'react';\r\n// tslint:disable-next-line:import-name\r\nimport AceEditor from 'react-ace';\r\n\r\nimport 'ace-builds/src-min-noconflict/mode-text';\r\nimport 'ace-builds/src-min-noconflict/theme-textmate';\r\nimport 'ace-builds/src-min-noconflict/theme-monokai';\r\nimport * as d3 from 'd3';\r\n\r\nimport './console.scss';\r\nimport { slot, signal, remove } from '../emitter';\r\nimport { LangProps } from '../Props';\r\nimport { DEBUG_STATE } from '../server';\r\ntype Props = LangProps;\r\n\r\ninterface State {\r\n  output: string;\r\n  isReadOnly: boolean;\r\n  outputChange: boolean;\r\n}\r\n\r\nexport default class Console extends React.Component<Props, State> {\r\n  constructor(props: Props) {\r\n    super(props);\r\n    this.state = { output: '', isReadOnly: true, outputChange: false };\r\n    this.onChange = this.onChange.bind(this);\r\n  }\r\n\r\n  componentDidMount() {\r\n    slot('changeOutput', (output: string, outputChange: boolean) => {\r\n      this.setState({ output, outputChange });\r\n    });\r\n    slot('changeState', async (debugState: DEBUG_STATE) => {\r\n      if (debugState === 'stdin') {\r\n        this.setState({ isReadOnly: false });\r\n      }\r\n    });\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    remove('changeOutput');\r\n    remove('changeState');\r\n  }\r\n\r\n  onChange(text: string) {\r\n    if (text.endsWith('\\n')) {\r\n      const sendText = text.slice(0, -1).replace(this.state.output, '');\r\n      this.setState({ output: text, isReadOnly: true });\r\n      signal('debug', 'Step', sendText);\r\n    }\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    if (this.state.outputChange) {\r\n      d3.select('#ConsolePanel')\r\n        .transition()\r\n        .duration(1000)\r\n        .tween('number', function () {\r\n          let i = d3.interpolateNumber(8, 16);\r\n          let j = d3.interpolateRgb('#ffffff', '#4A8CE3');\r\n          return function (t) {\r\n            d3.select('#ConsolePanel').style(\r\n              'box-shadow',\r\n              `0px 0px ${i(t)}px ${j(t)}`\r\n            );\r\n          };\r\n        });\r\n      d3.select('#ConsolePanel')\r\n        .transition()\r\n        .delay(1000)\r\n        .duration(1000)\r\n        .tween('number', function () {\r\n          let i = d3.interpolateNumber(16, 8);\r\n          let j = d3.interpolateRgb('#4A8CE3', '#ffffff');\r\n          return function (t) {\r\n            d3.select('#ConsolePanel').style(\r\n              'box-shadow',\r\n              `0px 0px ${i(t)}px ${j(t)}`\r\n            );\r\n          };\r\n        });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <AceEditor\r\n        mode=\"text\"\r\n        theme=\"light\"\r\n        value={this.state.output}\r\n        onChange={this.onChange}\r\n        name=\"IO\"\r\n        fontSize={14}\r\n        editorProps={{ $blockScrolling: true }}\r\n        setOptions={{\r\n          enableBasicAutocompletion: false,\r\n          enableLiveAutocompletion: false,\r\n          showLineNumbers: false,\r\n          readOnly: this.state.isReadOnly,\r\n          showGutter: false,\r\n        }}\r\n        style={{ height: '100%', width: '100%', marginTop: '.25rem' }}\r\n        className=\"console\"\r\n      />\r\n    );\r\n  }\r\n}\r\n","import React from 'react';\r\nimport './style.scss';\r\nimport Console from '../../components/console/Console';\r\nimport PanelHeader from '../../components/panelHeader/PanelHeader';\r\n\r\nfunction ConsolePanel() {\r\n  return (\r\n    <div id=\"ConsolePanel\" className=\"panel\">\r\n      <PanelHeader title=\"Console\" />\r\n      <div className=\"console-area\">\r\n        <Console lang=\"en\" />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ConsolePanel;\r\n","import React from 'react';\r\nimport { StatementHighlight } from '../../panels/timelinePanel/TimelinePanel';\r\n\r\ninterface StatementHighlightContentProps {\r\n  // changeStatementColor: (lineNumber: number, color: string) => void;\r\n  linesShowUp: StatementHighlight[];\r\n  changeStatementVisible: (lineNumber: number) => void;\r\n  statements: {[key: string]: string},\r\n}\r\n\r\nfunction StatementHighlightContent({statements, linesShowUp, changeStatementVisible}: StatementHighlightContentProps) {\r\n  return <div className=\"highlight-statements\">\r\n    <p className=\"header\">Highlight Statements</p>\r\n    <div className=\"content\">\r\n      <div>\r\n      {\r\n        Object.keys(statements).map((d, i) => (\r\n          <div key={i} className={[\"item\", linesShowUp[+d] && !linesShowUp[+d].visible ? 'disable': ''].join(' ')} \r\n            onClick={() => changeStatementVisible(+d)}\r\n          >\r\n            <span style={{background: statements[d]}}></span>\r\n            <p>Line number: {+d+1}</p>\r\n          </div>\r\n        ))\r\n      }\r\n      </div>\r\n    </div>\r\n  </div>;\r\n}\r\n\r\nexport default StatementHighlightContent;\r\n","export default __webpack_public_path__ + \"static/media/timelineLegend.6f5aabd8.svg\";","import * as React from 'react';\r\nimport { signal } from '../emitter';\r\nimport * as d3 from 'd3';\r\nimport {\r\n  VariableWithSteps,\r\n  StatementHighlight,\r\n} from '../../panels/timelinePanel/TimelinePanel';\r\n\r\nimport timelineLegend from '../../assets/icon/timelineLegend.svg';\r\n\r\ninterface Props {\r\n  step: number;\r\n  max: number;\r\n  scale: any;\r\n  width: number;\r\n  height: number;\r\n  variableHighlights: VariableWithSteps[];\r\n  statementHighlights: StatementHighlight[];\r\n  maxDepth: number;\r\n}\r\ninterface State {\r\n  dragging: boolean;\r\n  dragIndex?: any;\r\n}\r\n\r\nexport default class Slider extends React.Component<Props, State> {\r\n  componentDidMount() {\r\n    window.addEventListener('mouseup', this.dragEnd, false);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    window.removeEventListener('mouseup', this.dragEnd, false);\r\n  }\r\n\r\n  constructor(props: Props) {\r\n    super(props);\r\n    this.state = {\r\n      dragging: false,\r\n    };\r\n  }\r\n\r\n  rectScale = () => {\r\n    const { maxDepth } = this.props;\r\n    const range = 40;\r\n\r\n    if (maxDepth > 20) {\r\n      return d3.scaleLog().range([0, range]).domain([1e-15, maxDepth]);\r\n    } else {\r\n      return d3.scaleLinear().range([0, range]).domain([0, maxDepth]);\r\n    }\r\n  };\r\n\r\n  dragStart = (e: any) => {\r\n    e.stopPropagation();\r\n    if (!this.state.dragging) {\r\n      this.setState(\r\n        {\r\n          dragging: true,\r\n        },\r\n        () => {\r\n          this.setState({ dragging: true });\r\n        }\r\n      );\r\n    }\r\n  };\r\n\r\n  dragEnd = (e: any) => {\r\n    e.stopPropagation();\r\n    this.setState(\r\n      {\r\n        dragging: false,\r\n      },\r\n      () => {\r\n        this.setState({ dragging: false });\r\n      }\r\n    );\r\n  };\r\n\r\n  dragFromSVG = (e: React.MouseEvent) => {\r\n    if (this.props.max === 0) return;\r\n    if (!this.state.dragging) {\r\n      let step = this.props.scale.invert(e.nativeEvent.offsetX);\r\n      step = Math.min(step, this.props.max);\r\n      step = Math.max(step, 0);\r\n      step = Math.round(step);\r\n      signal('changeStep', step);\r\n      signal('jumpTo', step);\r\n      this.setState(\r\n        {\r\n          dragging: true,\r\n        },\r\n        () => {\r\n          this.setState({ dragging: true });\r\n        }\r\n      );\r\n    }\r\n  };\r\n\r\n  mouseMove = (e: React.MouseEvent) => {\r\n    if (this.props.max === 0) return;\r\n    if (this.state.dragging) {\r\n      let step = this.props.scale.invert(e.nativeEvent.offsetX);\r\n      step = Math.min(step, this.props.max);\r\n      step = Math.max(step, 0);\r\n      step = Math.round(step);\r\n      signal('changeStep', step);\r\n      signal('jumpTo', step);\r\n    }\r\n  };\r\n\r\n  render() {\r\n    const {\r\n      step,\r\n      max,\r\n      scale,\r\n      width,\r\n      height,\r\n      variableHighlights,\r\n      statementHighlights,\r\n    } = this.props;\r\n\r\n    // const contenWidth = width > 250 ? width - 60 : width;\r\n    const contentWidth = width;\r\n    const activeWidth = max ? (step / max) * contentWidth : 0;\r\n\r\n    // console.log(contentWidth, activeWidth, step, max);\r\n\r\n    return (\r\n      <div>\r\n        <svg\r\n          style={{\r\n            display: 'block',\r\n            // paddingBottom: '8px',\r\n            zIndex: 6,\r\n            overflow: 'visible',\r\n          }}\r\n          height={height}\r\n          width={contentWidth}\r\n          onMouseDown={this.dragFromSVG}\r\n          onMouseMove={this.mouseMove}\r\n        >\r\n          <rect\r\n            className=\"timeline\"\r\n            height={8}\r\n            x={0}\r\n            y={height / 2 - 4}\r\n            width={contentWidth}\r\n            rx=\"4\"\r\n            ry=\"4\"\r\n          />\r\n          <rect\r\n            className=\"timeline active\"\r\n            height={8}\r\n            x={0}\r\n            y={height / 2 - 4}\r\n            width={activeWidth}\r\n            rx=\"4\"\r\n            ry=\"4\"\r\n          />\r\n\r\n          <g>\r\n            {variableHighlights.map((m) => {\r\n              return (\r\n                <g key={m.funcName + '_' + m.name}>\r\n                  {m['steps'].map((_step, i) => {\r\n                    if (m['visible']) {\r\n                      return (\r\n                        <rect\r\n                          key={i}\r\n                          height={30}\r\n                          x={scale(_step) - 1.5}\r\n                          y={-30}\r\n                          width={3}\r\n                          fill={m['color']}\r\n                        />\r\n                      );\r\n                    }\r\n                    return null;\r\n                  })}\r\n                </g>\r\n              );\r\n            })}\r\n          </g>\r\n          <g>\r\n            {statementHighlights.map((m) => {\r\n              return (\r\n                <g key={m.lineNumber}>\r\n                  {m['steps'].map((_step, i) => {\r\n                    if (m['visible']) {\r\n                      return (\r\n                        <rect\r\n                          height={this.rectScale()(m['depth'][i])}\r\n                          x={scale(_step) - 1.5}\r\n                          y={height / 2 + 4}\r\n                          width={3}\r\n                          fill={m['color']}\r\n                        ></rect>\r\n                      );\r\n                    }\r\n                    return null;\r\n                  })}\r\n                </g>\r\n              );\r\n            })}\r\n          </g>\r\n          <g>\r\n            <image x={width - 80} y={-60} xlinkHref={timelineLegend} />\r\n            {/* <text\r\n              className=\"timeline-legend\"\r\n              x={contentWidth}\r\n              y={height / 2 - 20}\r\n              fontSize=\"15\"\r\n            >\r\n              Variables\r\n            </text>\r\n            <text\r\n              className=\"timeline-legend\"\r\n              x={contentWidth}\r\n              y={height / 2 + 35}\r\n              fontSize=\"15\"\r\n            >\r\n              Statements\r\n            </text> */}\r\n          </g>\r\n        </svg>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","export default __webpack_public_path__ + \"static/media/stepLight.1342c687.svg\";","export default __webpack_public_path__ + \"static/media/stepDark.4b3318fe.svg\";","export default __webpack_public_path__ + \"static/media/restartLight.8c265da1.svg\";","export default __webpack_public_path__ + \"static/media/restartDark.bc869dd8.svg\";","export default __webpack_public_path__ + \"static/media/stepBackLight.d6c0cb2a.svg\";","export default __webpack_public_path__ + \"static/media/stepBackDark.4ac60f09.svg\";","export default __webpack_public_path__ + \"static/media/kaishi2.c2674428.svg\";","export default __webpack_public_path__ + \"static/media/kaishi1.7a08fbf8.svg\";","import classNames from 'classnames';\r\nimport React from 'react';\r\nimport './style.scss';\r\n\r\ninterface ControlButtonProps {\r\n  iconHrefLight: string;\r\n  iconHrefDark: string;\r\n  onClick: () => void;\r\n  disabled: boolean;\r\n}\r\n\r\nfunction ControlButton({iconHrefLight, iconHrefDark, onClick, disabled}: ControlButtonProps) {\r\n  return (\r\n    <div\r\n      className={classNames('control-button', {disabled: disabled})}\r\n      onClick={onClick}\r\n    >\r\n      <svg width={40} height={40}>\r\n        <image xlinkHref={disabled ? iconHrefLight : iconHrefDark} height='40' width='40' cursor='pointer' />\r\n      </svg>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ControlButton;\r\n","import React, { useEffect, useState } from 'react';\r\n\r\nimport { DEBUG_STATE } from '../server';\r\nimport { showEvents, signal } from '../emitter';\r\nimport * as d3 from 'd3';\r\n\r\nimport stepLight from '../../assets/icon/stepLight.svg';\r\nimport stepDark from '../../assets/icon/stepDark.svg';\r\nimport stepAllLight from '../../assets/icon/stepAllLight.svg';\r\nimport stepAllDark from '../../assets/icon/stepAllDark.svg';\r\nimport restartLight from '../../assets/icon/restartLight.svg';\r\nimport restartDark from '../../assets/icon/restartDark.svg';\r\n\r\nimport stepBackLight from '../../assets/icon/stepBackLight.svg';\r\nimport stepBackDark from '../../assets/icon/stepBackDark.svg';\r\nimport backAllLight from '../../assets/icon/backAllLight.svg';\r\nimport backAllDark from '../../assets/icon/backAllDark.svg';\r\n\r\nimport startLight from '../../assets/icon/kaishi2.svg';\r\nimport startDark from '../../assets/icon/kaishi1.svg';\r\nimport ControlButton from './ControButton';\r\n\r\nimport './style.scss';\r\n\r\nfunction ControlButtonGroup({ debugState }: { debugState: DEBUG_STATE }) {\r\n  const [start, setStart] = useState(false);\r\n  const [stop, setStop] = useState(false);\r\n  const [backAll, setBackAll] = useState(false);\r\n  const [stepBack, setStepBack] = useState(false);\r\n  const [step, setStep] = useState(true);\r\n  const [stepAll, setStepAll] = useState(false);\r\n\r\n  useEffect(() => {\r\n    switch (debugState) {\r\n      case 'Stop':\r\n        setStart(true);\r\n        setStop(false);\r\n        setBackAll(false);\r\n        setStepBack(false);\r\n        setStep(false);\r\n        setStepAll(false);\r\n        break;\r\n      case 'First':\r\n        setStart(true);\r\n        setStop(true);\r\n        setBackAll(false);\r\n        setStepBack(false);\r\n        setStep(true);\r\n        setStepAll(true);\r\n        break;\r\n      case 'stdin':\r\n        setBackAll(false);\r\n        setStepBack(false);\r\n        setStep(true);\r\n        setStepAll(true);\r\n        break;\r\n      case 'Debugging':\r\n        setBackAll(true);\r\n        setStepBack(true);\r\n        setStep(true);\r\n        setStepAll(true);\r\n        break;\r\n      case 'Executing':\r\n        setBackAll(false);\r\n        setStepBack(false);\r\n        setStep(false);\r\n        setStepAll(false);\r\n        break;\r\n      case 'EOF':\r\n        setStart(true);\r\n        setStop(true);\r\n        setBackAll(true);\r\n        setStepBack(true);\r\n        setStep(false);\r\n        setStepAll(false);\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    return () => {};\r\n  }, [debugState]);\r\n\r\n  return (\r\n    <div className=\"control-btn-group\">\r\n      {/* <ControlButton\r\n        iconHrefLight={backAllLight}\r\n        iconHrefDark={backAllDark}\r\n        // onClick={() => signal('debug', 'BackAll')}\r\n        onClick={() => {}}\r\n        disabled={!backAll}\r\n      /> */}\r\n      <ControlButton\r\n        iconHrefLight={stepBackLight}\r\n        iconHrefDark={stepBackDark}\r\n        onClick={() => signal('debug', 'StepBack')}\r\n        disabled={!stepBack}\r\n      />\r\n      <ControlButton\r\n        iconHrefLight={stop ? restartLight : startLight}\r\n        iconHrefDark={stop ? restartDark : startDark}\r\n        onClick={() => {\r\n          signal('debug', 'Start');\r\n          const arrowListJson = sessionStorage.getItem('arrowList');\r\n          let arrowList =\r\n            arrowListJson === null ? {} : JSON.parse(arrowListJson);\r\n          if (!arrowList) {\r\n            arrowList = {};\r\n          }\r\n          Object.keys(arrowList).forEach((name) => {\r\n            d3.select('#svg')\r\n              .select(`#block_${name}`)\r\n              .attr('transform', 'matrix(1,0,0,1,0,0)');\r\n          });\r\n          sessionStorage.clear();\r\n        }}\r\n        disabled={!start}\r\n      />\r\n      <ControlButton\r\n        iconHrefLight={stepLight}\r\n        iconHrefDark={stepDark}\r\n        onClick={() => {\r\n          signal('debug', stop ? 'Step' : 'Start');\r\n        }}\r\n        disabled={!step}\r\n      />\r\n      {/* <ControlButton\r\n        iconHrefLight={stepAllLight}\r\n        iconHrefDark={stepAllDark}\r\n        // onClick={() => signal('debug', stop ? 'StepAll' : 'Exec')}\r\n        onClick={() => {}}\r\n        disabled={!stepAll}\r\n      /> */}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ControlButtonGroup;\r\n","import React, { useCallback, useEffect, useMemo, useState } from 'react';\r\nimport { scaleLinear as linear } from 'd3-scale';\r\nimport PanelHeader from '../../components/panelHeader/PanelHeader';\r\nimport StatementHighlightContent from '../../components/timeline/StatementHighlightContent';\r\nimport VariableHighlightContent from '../../components/timeline/VariableHighlightContent';\r\nimport './style.scss';\r\nimport '../../styles/colors.scss';\r\nimport * as d3 from 'd3';\r\nimport { inArray } from 'jquery';\r\nimport Slider from '../../components/timeline/Slider';\r\nimport ControlButtonGroup from '../../components/timeline/ControlButtonGroup';\r\nimport { DEBUG_STATE } from '../../components/server';\r\nimport { remove, slot } from '../../components/emitter';\r\nimport { unstable_batchedUpdates } from 'react-dom';\r\nimport { Variable } from 'unicoen.ts/dist/interpreter/Engine/Variable';\r\n\r\nimport { useSelector } from 'react-redux'\r\nimport '../../components/timeline/timeline.scss';\r\ninterface OptionItem {\r\n  value: string;\r\n  label: string;\r\n  children: { value: string; label: string }[];\r\n}\r\n\r\nexport interface StatementHighlight {\r\n  color: string;\r\n  lineNumber: number;\r\n  visible: boolean;\r\n  steps: number[];\r\n  depth: number[];\r\n}\r\n\r\nexport interface VariableWithSteps {\r\n  color: string;\r\n  funcName: string;\r\n  name: string;\r\n  visible: boolean;\r\n  steps: number[];\r\n  variable: Variable;\r\n}\r\n\r\ninterface TimelinePanelProps {\r\n  variableShowUps: VariableWithSteps[];\r\n  updVariableShowUps: (variableShowUps: VariableWithSteps[]) => void;\r\n}\r\n\r\nfunction TimelinePanel({ variableShowUps, updVariableShowUps }: TimelinePanelProps) {\r\n  const [max, setMax] = useState(0);\r\n  const [marks, setMarks] = useState({});\r\n  const [step, setStep] = useState(0);\r\n  const [variableHighlights, setVariableHighlights] = useState<\r\n    VariableWithSteps[]\r\n  >([]);\r\n  const [statementHighlights, setStatementHighlights] = useState<\r\n    StatementHighlight[]\r\n  >([]);\r\n  const [options, setOptions] = useState<OptionItem[]>([]);\r\n  const [linesShowUp, setLinesShowUp] = useState<StatementHighlight[]>([]);\r\n  const [debugStatus, setDebugStatus] = useState('');\r\n  const [debugState, setDebugState] = useState<DEBUG_STATE>('Stop');\r\n  const timelineArea = React.createRef<any>();\r\n  const [timelineWidth, setTimelineWidth] = useState(0);\r\n\r\n  const statements = useSelector((state) => (state as any).statements);\r\n  const variables = useSelector((state) => (state as any).variables);\r\n\r\n  useEffect(() => {\r\n    slot('changeStep', (step: number) => {\r\n      setStep(step);\r\n    });\r\n    slot('statementHighlight', (lineNumber: number) => {\r\n      const statement = linesShowUp[lineNumber];\r\n      const color = d3\r\n        .rgb(\r\n          Math.floor(Math.random() * 255),\r\n          Math.floor(Math.random() * 255),\r\n          Math.floor(Math.random() * 255)\r\n        )\r\n        .formatRgb();\r\n      alert(linesShowUp);\r\n      statement.color = color;\r\n      statementHighlights.push(statement);\r\n      setStatementHighlights(statementHighlights);\r\n      d3.selectAll(`.highlight${lineNumber}`).style('background-color', color);\r\n    });\r\n\r\n    slot('cancelStatementHighlight', (lineNumber: number) => {\r\n      for (let i = 0; i < statementHighlights.length; i++) {\r\n        if (statementHighlights[i]['lineNumber'] == lineNumber + 1) {\r\n          statementHighlights.splice(i, 1);\r\n          break;\r\n        }\r\n      }\r\n      d3.selectAll(`.highlight${lineNumber}`).style('background-color', '#fff');\r\n      setStatementHighlights(statementHighlights);\r\n    });\r\n    slot(\r\n      'init',\r\n      (\r\n        stepCount: number,\r\n        linesShowUp: any,\r\n        allVariables: any,\r\n        variableShowUp: any\r\n      ) => {\r\n        const options: OptionItem[] = [];\r\n        Object.keys(allVariables).forEach((funcName) => {\r\n          const temp: OptionItem = {\r\n            value: funcName,\r\n            label: funcName,\r\n            children: [],\r\n          };\r\n          Object.keys(allVariables[funcName]).forEach((varName) => {\r\n            temp.children.push({\r\n              value: varName,\r\n              label: varName,\r\n            });\r\n          });\r\n          options.push(temp);\r\n        });\r\n        console.log(options, 'options');\r\n        unstable_batchedUpdates(() => {\r\n          setMax(stepCount);\r\n          setVariableHighlights([]);\r\n          setStatementHighlights([]);\r\n          setLinesShowUp(linesShowUp);\r\n          updVariableShowUps(variableShowUp);\r\n          setOptions(options);\r\n        });\r\n        updVariableShowUps(variableShowUp);\r\n      }\r\n    );\r\n    slot('changeState', (debugState: DEBUG_STATE, step: number) => {\r\n      let debugStatus = '';\r\n      if (debugState === 'Debugging') {\r\n        debugStatus = `Step ${step}`;\r\n      } else {\r\n        debugStatus = debugState;\r\n      }\r\n      unstable_batchedUpdates(() => {\r\n        setDebugStatus(debugStatus);\r\n        setDebugState(debugState);\r\n      });\r\n    });\r\n\r\n    return () => {\r\n      remove('changeStep');\r\n      remove('statementHighlight');\r\n      remove('cancelStatementHighlight');\r\n      remove('init');\r\n      remove('changeState');\r\n    };\r\n  });\r\n\r\n  const changeStatementColor = (lineNumber: number, color: string) => {\r\n    for (let i = 0; i < statementHighlights.length; i++) {\r\n      if (statementHighlights[i].lineNumber === lineNumber) {\r\n        statementHighlights[i].color = color;\r\n        break;\r\n      }\r\n    }\r\n    d3.selectAll(`.highlight${lineNumber - 1}`).style(\r\n      'background-color',\r\n      color\r\n    );\r\n    setStatementHighlights(statementHighlights);\r\n  };\r\n\r\n  const changeStatementVisible = useCallback( (lineNumber: number) => {\r\n    if(!linesShowUp[lineNumber]) return;\r\n    \r\n    const lines = [...linesShowUp];\r\n    lines[lineNumber] = {...linesShowUp[lineNumber], visible: !linesShowUp[lineNumber].visible}\r\n    setLinesShowUp(lines);\r\n    // const len = statementHighlights.length;\r\n    // for (let i = 0; i < len; i++) {\r\n    //   if (statementHighlights[i].lineNumber === lineNumber) {\r\n    //     statementHighlights[i].visible = !statementHighlights[i].visible;\r\n    //     break;\r\n    //   }\r\n    // }\r\n    // setStatementHighlights(statementHighlights);\r\n  }, [linesShowUp])\r\n\r\n  const addVariableHighlight = (funcName: string, varName: string) => {\r\n    const color = d3\r\n      .rgb(\r\n        Math.floor(Math.random() * 255),\r\n        Math.floor(Math.random() * 255),\r\n        Math.floor(Math.random() * 255)\r\n      )\r\n      .formatRgb();\r\n    // console.log('addVariableHighlight: ', color);\r\n    let temp = null;\r\n    for (let i = 0; i < variableShowUps.length; i++) {\r\n      if (\r\n        variableShowUps[i].funcName === funcName &&\r\n        variableShowUps[i].name === varName\r\n      ) {\r\n        variableShowUps[i].color = color;\r\n        temp = variableShowUps[i];\r\n        break;\r\n      }\r\n    }\r\n    if (temp === null) {\r\n      alert('Unexcepted Variable');\r\n      return;\r\n    }\r\n    if (inArray(temp, variableHighlights) < 0) {\r\n      variableHighlights.push(temp);\r\n      setVariableHighlights(variableHighlights);\r\n      updVariableShowUps(variableShowUps);\r\n    }\r\n    const memoryCells = d3\r\n      .select('#memory')\r\n      .selectAll(`.memory-${funcName}-${varName}`);\r\n    memoryCells.select('rect').style('stroke', color);\r\n    memoryCells.selectAll('text').attr('fill', color);\r\n    const blockCells = d3\r\n      .select('#svg')\r\n      .selectAll(`.block-${funcName}-${varName}`);\r\n    blockCells.select('rect').style('stroke', color);\r\n    blockCells.selectAll('text').attr('fill', color);\r\n  };\r\n\r\n  const removeVariableHighlight = (funcName: string, varName: string) => {\r\n    for (let i = 0; i < variableShowUps.length; i++) {\r\n      if (\r\n        variableShowUps[i].funcName === funcName &&\r\n        variableShowUps[i].name === varName\r\n      ) {\r\n        variableShowUps[i].visible = true;\r\n        break;\r\n      }\r\n    }\r\n    for (let i = 0; i < variableHighlights.length; i++) {\r\n      for (let j = 0; j < variableHighlights.length; j++) {\r\n        if (\r\n          variableHighlights[j].funcName === funcName &&\r\n          variableHighlights[j].funcName === varName\r\n        ) {\r\n          variableHighlights.splice(i, 1);\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    const memoryCells = d3\r\n      .select('#memory')\r\n      .selectAll(`.memory-${funcName}-${varName}`);\r\n    memoryCells.select('rect').style('stroke', 'black');\r\n    memoryCells.selectAll('text').attr('fill', 'black');\r\n    const blockCells = d3\r\n      .select('#svg')\r\n      .selectAll(`.block-${funcName}-${varName}`);\r\n    blockCells.select('rect').style('stroke', 'black');\r\n    blockCells.selectAll('text').attr('fill', 'black');\r\n\r\n    setVariableHighlights(variableHighlights);\r\n    updVariableShowUps(variableShowUps);\r\n  };\r\n\r\n  const changeVariableColor = (\r\n    funcName: string,\r\n    varName: string,\r\n    color: string\r\n  ) => {\r\n    let i = 0;\r\n    for (; i < variableShowUps.length; i++) {\r\n      if (\r\n        variableShowUps[i].funcName === funcName &&\r\n        variableShowUps[i].name === varName\r\n      ) {\r\n        variableShowUps[i].color = color;\r\n        break;\r\n      }\r\n    }\r\n    for (let j = 0; j < variableHighlights.length; j++) {\r\n      if (\r\n        variableHighlights[j].funcName === funcName &&\r\n        variableHighlights[j].name === varName\r\n      ) {\r\n        variableHighlights[j].color = color;\r\n        break;\r\n      }\r\n    }\r\n    const memoryCells = d3\r\n      .select('#memory')\r\n      .selectAll(`.memory-${funcName}-${varName}`);\r\n    memoryCells.select('rect').style('stroke', color);\r\n    memoryCells.selectAll('text').attr('fill', color);\r\n    const blockCells = d3\r\n      .select('#svg')\r\n      .selectAll(`.block-${funcName}-${varName}`);\r\n    blockCells.select('rect').style('stroke', color);\r\n    blockCells.selectAll('text').attr('fill', color);\r\n\r\n    setVariableHighlights(variableHighlights);\r\n    updVariableShowUps(variableShowUps);\r\n  };\r\n\r\n  const changeVariableVisible = (funcName: string, varName: string) => {\r\n    for (let i = 0; i < variableShowUps.length; i++) {\r\n      if (\r\n        variableShowUps[i].funcName === funcName &&\r\n        variableShowUps[i]['name'] === varName\r\n      ) {\r\n        if (variableShowUps[i]['visible']) {\r\n          const memoryCells = d3\r\n            .select('#memory')\r\n            .selectAll(`.memory-${funcName}-${varName}`);\r\n          memoryCells.select('rect').style('stroke', 'black');\r\n          memoryCells.selectAll('text').attr('fill', 'black');\r\n          const blockCells = d3\r\n            .select('#svg')\r\n            .selectAll(`.block-${funcName}-${varName}`);\r\n          blockCells.select('rect').style('stroke', 'black');\r\n          blockCells.selectAll('text').attr('fill', 'black');\r\n        } else {\r\n          const memoryCells = d3\r\n            .select('#memory')\r\n            .selectAll(`.memory-${funcName}-${varName}`);\r\n          memoryCells\r\n            .select('rect')\r\n            .style('stroke', variableShowUps[i]['color']);\r\n          memoryCells\r\n            .selectAll('text')\r\n            .attr('fill', variableShowUps[i]['color']);\r\n          const blockCells = d3\r\n            .select('#svg')\r\n            .selectAll(`.block-${funcName}-${varName}`);\r\n          blockCells.select('rect').style('stroke', variableShowUps[i]['color']);\r\n          blockCells.selectAll('text').attr('fill', variableShowUps[i]['color']);\r\n        }\r\n        variableShowUps[i]['visible'] = !variableShowUps[i]['visible'];\r\n        break;\r\n      }\r\n    }\r\n\r\n    setVariableHighlights(variableHighlights);\r\n    updVariableShowUps(variableShowUps);\r\n  };\r\n\r\n  useEffect(() => {\r\n    setTimelineWidth(timelineArea.current.clientWidth - 60);\r\n  }, [timelineArea]);\r\n\r\n  useEffect(() => {\r\n    if(linesShowUp.length) {\r\n      setStatementHighlights(\r\n        Object.keys(statements).map(d => ({\r\n          ...linesShowUp[d as any],\r\n          color: statements[d],\r\n        }))\r\n      )\r\n    }\r\n  }, [linesShowUp, statements])\r\n\r\n  const maxDepth = useMemo(() => {\r\n    let max = 0;\r\n    Object.values(linesShowUp).forEach(({depth}) => {\r\n      max = Math.max(max, ...depth)\r\n    })\r\n\r\n    return max;\r\n  }, [linesShowUp])\r\n\r\n  useEffect(() => {\r\n    if(variableShowUps.length) {\r\n      console.log(variableShowUps, 'varib', variables)\r\n     \r\n      const highlights = variableShowUps.filter(({funcName, name}) => {\r\n        return variables[funcName+'-'+name]\r\n      }).map(d => {\r\n        return ({\r\n          ...d,\r\n          color: variables[d.funcName+'-'+d.name]\r\n        })\r\n      })\r\n\r\n      setVariableHighlights(highlights)\r\n    }\r\n  }, [variableShowUps, variables])\r\n\r\n  return (\r\n    <div id=\"TimelinePanel\" className=\"panel\">\r\n      <PanelHeader title=\"Timeline\" />\r\n      <div className=\"main-content\">\r\n        <div className=\"col-2\" ref={timelineArea}>\r\n          <div className=\"row-1\">\r\n            <Slider\r\n              step={step}\r\n              max={max}\r\n              scale={linear().domain([0, max]).range([0, timelineWidth])}\r\n              width={timelineWidth}\r\n              height={8}\r\n              maxDepth={maxDepth}\r\n              variableHighlights={variableHighlights}\r\n              statementHighlights={statementHighlights}\r\n            />\r\n          </div>\r\n          <div className=\"row-2\">\r\n            <ControlButtonGroup debugState={debugState} />\r\n          </div>\r\n        </div>\r\n        <div className=\"col-1\">\r\n          <StatementHighlightContent\r\n            statements={statements}\r\n            linesShowUp={linesShowUp}\r\n            // changeStatementColor={changeStatementColor}\r\n            // statementHighlights={statementHighlights}\r\n            changeStatementVisible={changeStatementVisible}\r\n          />\r\n        </div>\r\n        {/* <div className=\"col-3\">\r\n          <VariableHighlightContent\r\n            variableHighlights={variableHighlights}\r\n            options={options}\r\n          // addVariableHighlight={addVariableHighlight}\r\n          // changeVariableColor={changeVariableColor}\r\n          // changeVariableVisible={changeVariableVisible}\r\n          // removeVariableHighlight={removeVariableHighlight}\r\n          />\r\n        </div> */}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default TimelinePanel;\r\n","import { ExecState } from 'unicoen.ts/dist/interpreter/Engine/ExecState';\r\nimport { Stack } from 'unicoen.ts/dist/interpreter/Engine/Stack';\r\nimport { Variable } from 'unicoen.ts/dist/interpreter/Engine/Variable';\r\nimport { Vector } from 'vector2d';\r\n\r\nexport type BlockCellContainer = BlockCell[];\r\nexport type BlockTable = BlockCellContainer[];\r\n\r\nexport function arrayToString(value: number | any[], type: string) {\r\n  const array = valueToArray(value, type);\r\n  if (Array.isArray(value)) {\r\n    if (\r\n      (type.startsWith('char') || type.startsWith('unsignedchar')) &&\r\n      type.split('[').length === 2\r\n    ) {\r\n      return '\"' + array.toString() + '\"';\r\n    }\r\n    return '[' + array.toString() + ']';\r\n  }\r\n  return array.toString();\r\n}\r\n\r\nexport function valueToArray(value: number | any[], type: string) {\r\n  const res: string[] = [];\r\n  if (Array.isArray(value)) {\r\n    value.forEach((v) => {\r\n      res.push(arrayToString(v.value, v.type));\r\n    });\r\n  } else {\r\n    if (type === 'char' || type === 'unsignedchar') {\r\n      return typeof value === undefined || value === 0\r\n        ? ''\r\n        : String.fromCharCode(value);\r\n    } else {\r\n      return value ? value : 0;\r\n    }\r\n  }\r\n  if (\r\n    (type.startsWith('char') || type.startsWith('unsignedchar')) &&\r\n    type.split('[').length === 2\r\n  ) {\r\n    return [res.join('')];\r\n  }\r\n  return res;\r\n}\r\n\r\nexport class BlockDrawer {\r\n  private blockStacks: BlockStack[] = [];\r\n  private blockArrows: any = [null, null];\r\n  private execState: ExecState | null = null;\r\n  constructor(execState?: ExecState) {\r\n    if (typeof execState === 'undefined') return;\r\n    this.execState = execState;\r\n    this.reset();\r\n    this.update();\r\n    this.calcPos();\r\n  }\r\n  private reset() {\r\n    this.blockStacks = [];\r\n  }\r\n\r\n  private update() {\r\n    if (this.execState === null) return;\r\n    const stacks = this.execState.getStacks();\r\n    stacks.forEach((stack, i) => {\r\n      if (stack.name !== 'GLOBAL') {\r\n        const blockStack = new BlockStack(stack);\r\n        blockStack.setColor('#979797');\r\n        this.blockStacks.push(blockStack);\r\n      }\r\n    });\r\n  }\r\n\r\n  private calcPos() {\r\n    const originX = 300;\r\n    const originY = 5;\r\n    const offsetX = 40;\r\n    const offsetY = 40;\r\n    const x = originX;\r\n    let y = originY;\r\n    this.blockStacks.slice(-2).forEach((blockStack, index) => {\r\n      this.blockArrows[index] = blockStack.getName();\r\n      const height = this.calcStackPos(x, y, blockStack);\r\n      y += height + offsetY;\r\n    });\r\n\r\n    this.blockStacks.slice(0, -2).forEach((blockStack, index) => {\r\n      this.calcStackPos(0, 0, blockStack);\r\n    });\r\n  }\r\n\r\n  private calcStackPos(x: number, y: number, blockStack: BlockStack) {\r\n    blockStack.setPos(x, y);\r\n    const offsetX = 20;\r\n    const offsetY = 40;\r\n    const originX = x + offsetX;\r\n    const originY = y + 20;\r\n    let row = 1;\r\n    let count = 0;\r\n    const blockTable = blockStack.getBlockTable();\r\n    blockTable.forEach((blockCellContainer) => {\r\n      const len = 1;\r\n      if (count + len > 2) {\r\n        row++;\r\n        count = 0;\r\n      }\r\n      const _x = originX + (offsetX + BlockCell.WIDTH) * count + offsetX;\r\n      const _y =\r\n        originY + (offsetY + BlockCell.HEIGHT) * row - BlockCell.HEIGHT;\r\n      this.calcVariablePos(_x, _y, blockCellContainer);\r\n      count += len;\r\n    });\r\n    blockStack.setHeight((BlockCell.HEIGHT + offsetY) * row + offsetY * 2);\r\n    blockStack.setWidth((BlockCell.WIDTH + offsetX) * 2 + offsetX * 3);\r\n\r\n    return (BlockCell.HEIGHT + offsetY) * row + offsetY * 2;\r\n  }\r\n\r\n  private calcVariablePos(\r\n    x: number,\r\n    y: number,\r\n    blockCellContainer: BlockCellContainer\r\n  ) {\r\n    const offsetX = 20 + BlockCell.WIDTH;\r\n    blockCellContainer[0].setPos(x, y);\r\n  }\r\n\r\n  // private calcVariablePos(\r\n  //   x: number,\r\n  //   y: number,\r\n  //   blockCellContainer: BlockCellContainer\r\n  // ) {\r\n  //   const offsetX = 20 + BlockCell.WIDTH;\r\n  //   if (blockCellContainer.length === 1) {\r\n  //     blockCellContainer[0].setPos(x, y);\r\n  //   } else {\r\n  //     blockCellContainer[0].setPos(x - 10, y - 10);\r\n  //     blockCellContainer[0].setWidth(\r\n  //       offsetX * Math.min(getCellsByDepth(blockCellContainer, 1).length, 3)\r\n  //     );\r\n  //     blockCellContainer[0].setHeight(BlockCell.HEIGHT + 20);\r\n  //     const depth = getDepth(blockCellContainer);\r\n  //     for (let i = 1; i <= depth; i++) {\r\n  //       const blockCells = getCellsByDepth(blockCellContainer, i);\r\n  //       blockCells.forEach((blockCell) => {});\r\n  //     }\r\n  //   }\r\n  // }\r\n\r\n  public getBlockStacks() {\r\n    return this.blockStacks;\r\n  }\r\n\r\n  public getBlockArrows() {\r\n    return this.blockArrows;\r\n  }\r\n\r\n  public addBlockStack(blockStack: BlockStack) {\r\n    this.blockStacks.push(blockStack);\r\n  }\r\n\r\n  public addArrow(stackName: any) {\r\n    this.blockArrows.push(stackName);\r\n  }\r\n}\r\n\r\nexport class BlockStack {\r\n  public readonly key: string;\r\n  private pos: Vector = new Vector(0, 0);\r\n  private blockTable: BlockTable;\r\n  private stack: Stack;\r\n  private width = 0;\r\n  private height = 0;\r\n  private color: string | undefined;\r\n\r\n  constructor(stack: Stack) {\r\n    this.stack = stack;\r\n    this.blockTable = this.makeBlockTable();\r\n    this.key = stack.name;\r\n  }\r\n\r\n  public setPos(x: number, y: number) {\r\n    this.pos.setAxes(x, y);\r\n  }\r\n\r\n  public setWidth(width: number) {\r\n    this.width = width;\r\n  }\r\n\r\n  public setHeight(height: number) {\r\n    this.height = height;\r\n  }\r\n\r\n  public setColor(color: string) {\r\n    this.color = color;\r\n  }\r\n\r\n  private makeBlockTable(): BlockTable {\r\n    const blockTable: BlockTable = [];\r\n    const variables = this.stack.getVariables();\r\n    const stackName = this.stack.name;\r\n    variables.forEach((variable) => {\r\n      const value = variable.getValue();\r\n      const isArrayVariable = Array.isArray(value);\r\n      const blockVariable = isArrayVariable\r\n        ? new BlockArrayVariable(variable, stackName)\r\n        : new BlockVariable(variable, stackName);\r\n      const cellss = blockVariable.getBlockCellContainer();\r\n      blockTable.push(cellss);\r\n    });\r\n    return blockTable;\r\n  }\r\n\r\n  public getBlockTable() {\r\n    return this.blockTable;\r\n  }\r\n\r\n  public x() {\r\n    return this.pos.getX();\r\n  }\r\n\r\n  public y() {\r\n    return this.pos.getY();\r\n  }\r\n\r\n  public getWidth() {\r\n    return this.width;\r\n  }\r\n\r\n  public getHeight() {\r\n    return this.height;\r\n  }\r\n\r\n  public getName() {\r\n    const res = this.key.replace(/[&|\\\\*:^%$@()[\\].]/g, '_');\r\n    return res;\r\n  }\r\n\r\n  public getColor() {\r\n    return this.color;\r\n  }\r\n}\r\n\r\nexport class BlockVariable {\r\n  public readonly key: string;\r\n  protected blockCellContainer: BlockCellContainer = [];\r\n  protected readonly variable: Variable;\r\n  protected readonly stackName: string;\r\n  constructor(variable: Variable, stackName: string) {\r\n    this.variable = variable;\r\n    this.stackName = stackName;\r\n    this.key = `${stackName}-${variable.name}`;\r\n    this.key = this.key.replace(/[&|\\\\*:^%$@()[\\].]/g, '_');\r\n    this.init();\r\n  }\r\n\r\n  protected init() {\r\n    const { type, name, address } = this.variable;\r\n    const cell = this.pushCell(name, this.variable.getValue());\r\n    cell.setType(type);\r\n    cell.setAddress(address);\r\n  }\r\n\r\n  protected pushCell(name: string, value: any): BlockCell {\r\n    const cell = new BlockCell(name, this.key, value);\r\n    this.blockCellContainer.push(cell);\r\n    return cell;\r\n  }\r\n\r\n  public getBlockCellContainer(): BlockCellContainer {\r\n    return this.blockCellContainer;\r\n  }\r\n}\r\n\r\nexport class BlockArrayVariable extends BlockVariable {\r\n  constructor(variable: Variable, stackName: string) {\r\n    super(variable, stackName);\r\n  }\r\n\r\n  public getBlockCellContainer(): BlockCellContainer {\r\n    const children: BlockCellContainer = [];\r\n    const value: Variable[] = this.variable.getValue();\r\n    for (const v of value) {\r\n      const blockVariable = Array.isArray(v.getValue())\r\n        ? new BlockArrayVariable(v, this.stackName)\r\n        : new BlockVariable(v, this.stackName);\r\n      const table = blockVariable.getBlockCellContainer();\r\n      children.push(...table);\r\n    }\r\n    return this.blockCellContainer.concat(children);\r\n  }\r\n}\r\n\r\nexport class BlockCell {\r\n  public static readonly FONT_SIZE: number = 20;\r\n  public static readonly HEIGHT: number = 50;\r\n  public static readonly WIDTH: number = 150;\r\n  private address: number | undefined;\r\n  public readonly key: string;\r\n  private type: string | undefined;\r\n  private name: string;\r\n  private pos: Vector = new Vector(-1, -1);\r\n  private value: any;\r\n  private depth = 0;\r\n  private width: number = BlockCell.WIDTH;\r\n  private height: number = BlockCell.HEIGHT;\r\n  constructor(name: string, parentKey: string, value: any) {\r\n    this.name = name;\r\n    this.key = parentKey;\r\n    this.key = this.key.replace(/[&|\\\\*:^%$@()[\\].]/g, '_');\r\n    this.value = value;\r\n    this.depth = this.name.split('[').length - 1;\r\n  }\r\n\r\n  public setAddress(address: number) {\r\n    this.address = address;\r\n  }\r\n\r\n  public setType(type: string) {\r\n    this.type = type;\r\n  }\r\n\r\n  public setPos(x: number, y: number) {\r\n    this.pos.setAxes(x, y);\r\n  }\r\n\r\n  public setWidth(width: number) {\r\n    this.width = width;\r\n  }\r\n\r\n  public setHeight(height: number) {\r\n    this.height = height;\r\n  }\r\n\r\n  public getAddress() {\r\n    return this.address;\r\n  }\r\n\r\n  public getType() {\r\n    return this.type;\r\n  }\r\n\r\n  public getName() {\r\n    return this.name;\r\n  }\r\n\r\n  public x() {\r\n    return this.pos.getX();\r\n  }\r\n\r\n  public y() {\r\n    return this.pos.getY();\r\n  }\r\n\r\n  public getValue() {\r\n    if (this.type!.split('[').length > 1) {\r\n      return arrayToString(this.value, this.type!.split('[')[0]);\r\n    }\r\n\r\n    return this.value.toString();\r\n  }\r\n\r\n  public getDepth() {\r\n    return this.depth;\r\n  }\r\n\r\n  public getWidth() {\r\n    return this.width;\r\n  }\r\n\r\n  public getHeight() {\r\n    return this.height;\r\n  }\r\n}\r\n","import * as React from 'react';\r\nimport { BlockStack, BlockCell } from '../blockDrawer/BlockDrawer';\r\nimport * as d3 from 'd3';\r\n\r\ninterface Props {\r\n  blockStack: BlockStack;\r\n}\r\n\r\n// eslint-disable-next-line @typescript-eslint/no-empty-interface\r\ninterface State {}\r\n\r\nexport function wrapWord(\r\n  text: d3.Selection<d3.BaseType, unknown, HTMLElement, any>,\r\n  width: number,\r\n  className:\r\n    | string\r\n    | number\r\n    | boolean\r\n    | d3.ValueFn<SVGTSpanElement, unknown, string | number | boolean | null>\r\n    | null\r\n) {\r\n  text.each(function () {\r\n    const text = d3.select(this),\r\n      words = text.text().split('').reverse();\r\n    let word;\r\n    const line = [],\r\n      x = text.attr('x'),\r\n      y = text.attr('y'),\r\n      tspan = text\r\n        .text(null)\r\n        .append('tspan')\r\n        .attr('class', className)\r\n        .attr('x', x)\r\n        .attr('y', y);\r\n    while ((word = words.pop())) {\r\n      line.push(word);\r\n      tspan.text(line.join(''));\r\n      if (tspan.node()!.getComputedTextLength() > width) {\r\n        line.pop();\r\n        line.splice(line.length - 2, 3, '.', '.', '.');\r\n        tspan.text(line.join(''));\r\n        break;\r\n      }\r\n    }\r\n  });\r\n}\r\n\r\nexport default class Block extends React.Component<Props, State> {\r\n  componentDidUpdate() {\r\n    wrapWord(d3.selectAll('.value'), BlockCell.WIDTH - 10, 'value');\r\n  }\r\n\r\n  renderBlockBackground() {\r\n    const { blockStack } = this.props;\r\n    return (\r\n      <React.Fragment>\r\n        <rect\r\n          x={blockStack.x()}\r\n          y={blockStack.y()}\r\n          width={blockStack.getWidth()}\r\n          height={blockStack.getHeight()}\r\n          rx={10}\r\n          ry={10}\r\n          fill=\"white\"\r\n          style={{ stroke: '#979797', strokeWidth: '1.5px' }}\r\n        ></rect>\r\n        <g className=\"block-left\"></g>\r\n        {/* <path\r\n          d={\r\n            'M ' +\r\n            blockStack.x() +\r\n            ' ' +\r\n            (blockStack.y() + 10) +\r\n            ' L ' +\r\n            blockStack.x() +\r\n            ' ' +\r\n            (blockStack.y() + blockStack.getHeight() - 10) +\r\n            ' A 10 10 0 0 0 ' +\r\n            (blockStack.x() + 10) +\r\n            ' ' +\r\n            (blockStack.y() + blockStack.getHeight()) +\r\n            ' L ' +\r\n            (blockStack.x() + 10) +\r\n            ' ' +\r\n            blockStack.y() +\r\n            ' A 10 10 0 0 0 ' +\r\n            blockStack.x() +\r\n            ' ' +\r\n            (blockStack.y() + 10)\r\n          }\r\n          fill=\"black\"\r\n          stroke=\"black\"\r\n          strokeWidth={2}\r\n        /> */}\r\n        <text\r\n          x={blockStack.x() + 15}\r\n          y={blockStack.y() + BlockCell.FONT_SIZE + 7}\r\n          fontSize={BlockCell.FONT_SIZE + 2}\r\n          fill={blockStack.getColor()}\r\n          className=\"function-name\"\r\n        >\r\n          {blockStack.key.split('.')[0]}\r\n        </text>\r\n      </React.Fragment>\r\n    );\r\n  }\r\n\r\n  renderBlockContent() {\r\n    const { blockStack } = this.props;\r\n    const list: JSX.Element[] = [];\r\n    const blockTable = blockStack.getBlockTable();\r\n    blockTable.forEach((blockCellContainer) => {\r\n      for (let i = 0; i < 1; i++) {\r\n        if (i >= 3) break;\r\n        const blockCell = blockCellContainer[i];\r\n        list.push(\r\n          <g\r\n            className={`block-${\r\n              blockStack.key.split('.')[0]\r\n            }-${blockCell.getName()}`}\r\n            id={`block-${blockStack.key.replace(\r\n              '.',\r\n              '_'\r\n            )}-${blockCell.getName()}`}\r\n            key={`block-${blockStack.key.replace(\r\n              '.',\r\n              '_'\r\n            )}-${blockCell.getName()}`}\r\n            transform=\"matrix(1,0,0,1,0,0)\"\r\n          >\r\n            <text\r\n              x={blockCell.x() + 5}\r\n              y={blockCell.y() - 5}\r\n              fontSize={BlockCell.FONT_SIZE}\r\n              fontWeight=\"blod\"\r\n              fill={blockStack.getColor()}\r\n              className=\"variable-name\"\r\n            >\r\n              {blockCell.getName()}\r\n            </text>\r\n            <rect\r\n              x={blockCell.x()}\r\n              y={blockCell.y()}\r\n              width={blockCell.getWidth()}\r\n              height={blockCell.getHeight()}\r\n              fill=\"white\"\r\n              style={{ stroke: blockStack.getColor(), strokeWidth: '1.5px' }}\r\n            />\r\n            <text\r\n              className=\"value variable-value\"\r\n              x={blockCell.x() + 10}\r\n              y={blockCell.y() + BlockCell.FONT_SIZE + 10}\r\n              fontSize={BlockCell.FONT_SIZE}\r\n              fill={blockStack.getColor()}\r\n            >\r\n              {blockCell.getValue()}\r\n            </text>\r\n          </g>\r\n        );\r\n      }\r\n    });\r\n    return list;\r\n  }\r\n\r\n  render() {\r\n    const backgroud = this.renderBlockBackground();\r\n    const content = this.renderBlockContent();\r\n    return (\r\n      <g\r\n        className=\"block\"\r\n        transform=\"matrix(1,0,0,1,0,0)\"\r\n        id={`block_${this.props.blockStack.getName()}`}\r\n      >\r\n        {backgroud}\r\n        {content}\r\n      </g>\r\n    );\r\n  }\r\n}\r\n","import * as React from 'react';\r\nimport { BlockDrawer, BlockStack } from './/blockDrawer/BlockDrawer';\r\nimport Block from './block/Block';\r\nimport * as d3 from 'd3';\r\nimport { inArray } from 'jquery';\r\nimport { select, Selection } from 'd3-selection';\r\nimport 'd3-clone';\r\n\r\ninterface Props {\r\n  blockDrawer: BlockDrawer;\r\n}\r\n\r\ninterface State {\r\n  blockStacks: BlockStack[];\r\n}\r\n\r\n// function dragged(d: any) {\r\n//   const temp = d3.select(this).attr('id').split('_');\r\n//   temp.shift();\r\n//   const stackName = temp.join('_');\r\n//   d3.select(this).attr('transform', function () {\r\n//     let source = this.attributes.transform.value.replace(')', '');\r\n//     source = source.split(',');\r\n//     const tx = d.dx + Number(source[4]);\r\n//     const ty = d.dy + Number(source[5]);\r\n//     return 'matrix(1,0,0,1,' + tx + ',' + ty + ')';\r\n//   });\r\n//   d3.select('#svg').select(`#arrow_${stackName}`).remove();\r\n//   renderArrow(stackName, stackName);\r\n// }\r\n\r\nexport function renderArrow(sourceStackName: string, targetStackName: string) {\r\n  d3.select('#svg').select(`#arrow_${sourceStackName}`).remove();\r\n  const source = d3\r\n    .select('#svg')\r\n    .select(`#stack_${sourceStackName}`)\r\n    .select('rect');\r\n  let target = d3.select('#svg').select(`#block_${targetStackName}`);\r\n  if (target.empty()) {\r\n    return;\r\n  }\r\n  const sourceX =\r\n    Number(source.attr('x')) +\r\n    Number(source.attr('width')) -\r\n    0.36 * 0.2 * Number(source.attr('height'));\r\n  const sourceY =\r\n    Number(source.attr('y')) + 0.2 * Number(source.attr('height'));\r\n  const transform = target.attr('transform').replace(')', '').split(',');\r\n  target = target.select('rect');\r\n  const targetX = Number(target.attr('x')) + Number(transform[4]);\r\n  const height = d3\r\n    .select(target as any)\r\n    .node()\r\n    .node()\r\n    .getBBox().height;\r\n  const targetY = Number(target.attr('y')) + Number(transform[5]) + height / 2;\r\n  let temp = sourceX - targetX;\r\n  temp = Math.max(temp, -temp);\r\n  d3.select('#svg')\r\n    .select('#path')\r\n    .append('path')\r\n    .attr('style', 'stroke:#858585; fill:none; stroke-width:2;')\r\n    .attr('id', `arrow_${sourceStackName}`)\r\n    .attr(\r\n      'd',\r\n      'M' +\r\n        sourceX +\r\n        ',' +\r\n        sourceY +\r\n        ' C' +\r\n        (targetX - temp / 3) +\r\n        ',' +\r\n        sourceY +\r\n        ' ' +\r\n        (sourceX + temp / 3) +\r\n        ',' +\r\n        targetY +\r\n        ' ' +\r\n        targetX +\r\n        ',' +\r\n        targetY\r\n    )\r\n    .attr('marker-end', 'url(#end)')\r\n    .attr('marker-start', 'url(#start)');\r\n}\r\n\r\nexport default class CallStack extends React.Component<Props, State> {\r\n  constructor(props: Props) {\r\n    super(props);\r\n    this.state = {\r\n      blockStacks: props.blockDrawer.getBlockStacks(),\r\n    };\r\n    const arrowListJson = sessionStorage.getItem('arrowList');\r\n    let arrowList = JSON.parse(arrowListJson!);\r\n    props.blockDrawer.getBlockArrows().forEach((name: string | number) => {\r\n      if (!arrowList) {\r\n        arrowList = {};\r\n      }\r\n      if (name) {\r\n        arrowList[name] = '';\r\n      }\r\n    });\r\n    sessionStorage.setItem('arrowList', JSON.stringify(arrowList));\r\n  }\r\n\r\n  componentWillUpdate(nextProps: {\r\n    blockDrawer: { getBlockStacks: () => any; getBlockArrows: () => any[] };\r\n  }) {\r\n    d3.select('#stack__cloned').remove();\r\n    d3.select('#block__cloned').remove();\r\n    d3.select('#arrow__cloned').remove();\r\n    const blockStacks = this.props.blockDrawer.getBlockStacks();\r\n    const nextBlockStacks = nextProps.blockDrawer.getBlockStacks();\r\n\r\n    if (sessionStorage.getItem('exec') !== 'step') {\r\n      const blockStacksLen = blockStacks.length;\r\n      const nextBlockStacksLen = nextBlockStacks.length;\r\n      if (blockStacksLen > nextBlockStacksLen) {\r\n        for (let i = nextBlockStacksLen; i < blockStacksLen; i++) {\r\n          const clonedStack = (\r\n            d3.select('#svg').select('#clone') as any\r\n          ).appendClone(\r\n            d3.select('#stack_' + blockStacks[i].key.replace('.', '_'))\r\n          );\r\n          clonedStack.attr('id', 'stack__cloned');\r\n          const clonedBlock = (\r\n            d3.select('#svg').select('#clone') as any\r\n          ).appendClone(\r\n            d3.select('#block_' + blockStacks[i].key.replace('.', '_'))\r\n          );\r\n          clonedBlock.select('rect').style('stroke', '#979797');\r\n          clonedBlock.select('text').style('fill', '#979797');\r\n          let offsetY = 0;\r\n          if (i > 1) {\r\n            offsetY = blockStacks[i].getHeight() + 40;\r\n          }\r\n          clonedBlock.selectAll('rect').attr('y', function (this: any) {\r\n            return Number(d3.select(this).attr('y')) + offsetY;\r\n          });\r\n          clonedBlock.selectAll('text').attr('y', function (this: any) {\r\n            return Number(d3.select(this).attr('y')) + offsetY;\r\n          });\r\n          clonedBlock.selectAll('tspan').attr('y', function (this: any) {\r\n            return Number(d3.select(this).attr('y')) + offsetY;\r\n          });\r\n          const block = d3.select(\r\n            '#block_' + blockStacks[i].key.replace('.', '_')\r\n          );\r\n          clonedBlock.attr('id', 'block__cloned');\r\n          const list: string[] = [];\r\n          block.selectAll('g').attr('copy', function () {\r\n            return list.push(d3.select(this).attr('id'));\r\n          });\r\n          clonedBlock.selectAll('g').attr('id', function (d: any, i: number) {\r\n            return 'cloned-' + list[i];\r\n          });\r\n        }\r\n      } else if (nextBlockStacksLen > blockStacksLen && blockStacksLen >= 2) {\r\n        const clonedBlock = (\r\n          d3.select('#svg').select('#clone') as any\r\n        ).appendClone(\r\n          d3.select(\r\n            '#block_' + blockStacks[blockStacksLen - 2].key.replace('.', '_')\r\n          )\r\n        );\r\n        clonedBlock.attr('id', 'block__cloned');\r\n      }\r\n    }\r\n    const arrowListJson = sessionStorage.getItem('arrowList');\r\n    let arrowList = JSON.parse(arrowListJson!);\r\n    if (!arrowList) {\r\n      arrowList = {};\r\n    }\r\n    nextProps.blockDrawer.getBlockArrows().forEach((name) => {\r\n      if (inArray(name, Object.keys(arrowList)) >= 0) {\r\n        delete arrowList[name];\r\n        d3.select('#svg')\r\n          .select(`#block_${name}`)\r\n          .attr('transform', 'matrix(1,0,0,1,0,0)');\r\n      }\r\n    });\r\n    sessionStorage.setItem('arrowList', JSON.stringify(arrowList));\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    d3.select('#svg').selectAll('.block-left').selectAll('path').remove();\r\n    d3.select('#svg')\r\n      .selectAll('.block-left')\r\n      .append('path')\r\n      .attr('d', function (this: any) {\r\n        const block_node = d3\r\n          .select(this.parentNode.parentNode)\r\n          .node()\r\n          .getBBox();\r\n        const x = block_node.x;\r\n        const y = block_node.y;\r\n        const height = block_node.height;\r\n        return (\r\n          'M ' +\r\n          x +\r\n          ' ' +\r\n          (y + 10) +\r\n          ' L ' +\r\n          x +\r\n          ' ' +\r\n          (y + height - 10) +\r\n          ' A 10 10 0 0 0 ' +\r\n          (x + 10) +\r\n          ' ' +\r\n          (y + height) +\r\n          ' L ' +\r\n          (x + 10) +\r\n          ' ' +\r\n          y +\r\n          ' A 10 10 0 0 0 ' +\r\n          x +\r\n          ' ' +\r\n          (y + 10)\r\n        );\r\n      });\r\n    // d3.select('#svg').selectAll('.block').call(d3.drag().on('drag', dragged));\r\n    d3.select('#svg').select('#path').selectAll('path').remove();\r\n\r\n    const { blockDrawer } = this.props;\r\n    const blockArrows = blockDrawer.getBlockArrows();\r\n    blockArrows.forEach((stackName: string) => {\r\n      if (!d3.select('#svg').select(`#block_${stackName}`).empty()) {\r\n        renderArrow(stackName, stackName);\r\n      }\r\n    });\r\n    const arrowListJson = sessionStorage.getItem('arrowList');\r\n    let arrowList = JSON.parse(arrowListJson!);\r\n    if (!arrowList) {\r\n      arrowList = {};\r\n    }\r\n    Object.keys(arrowList).forEach((stackName) => {\r\n      if (!d3.select('#svg').select(`#block_${stackName}`).empty()) {\r\n        renderArrow(stackName, stackName);\r\n      }\r\n    });\r\n    // const variablesMapJson = sessionStorage.getItem('variablesMap');\r\n    // let variablesMap = JSON.parse(variablesMapJson!);\r\n    // if (!variablesMap) {\r\n    //   variablesMap = {};\r\n    // }\r\n    // Object.keys(variablesMap).forEach((key) => {\r\n    //   if (variablesMap[key]['visible']) {\r\n    //     const stackName = key.split('_')[0];\r\n    //     const name = key.split('_')[1];\r\n    //     const cells = d3\r\n    //       .select('#svg')\r\n    //       .selectAll(`.block-${stackName}-${name}`);\r\n    //     cells.select('rect').style('stroke', variablesMap[key]['color']);\r\n    //     cells.selectAll('text').attr('fill', variablesMap[key]['color']);\r\n    //   }\r\n    // });\r\n    const activeStack = sessionStorage.getItem('activeStack');\r\n    const blocks = d3.select('#svg').selectAll('.block');\r\n    blocks.select('rect').style('stroke', '#979797');\r\n    blocks.select('text').style('fill', '#979797');\r\n    // const block = d3.select('#svg').select('#block_' + activeStack);\r\n    // block.select('rect').style('stroke', '#0074D9');\r\n    // block.select('text').style('fill', '#0074D9');\r\n  }\r\n\r\n  renderBlocks() {\r\n    const { blockDrawer } = this.props;\r\n    const blockStacks = blockDrawer.getBlockStacks();\r\n    const blockArrows = blockDrawer.getBlockArrows();\r\n    const arrowListJson = sessionStorage.getItem('arrowList');\r\n    let arrowList = JSON.parse(arrowListJson!);\r\n    if (!arrowList) {\r\n      arrowList = {};\r\n    }\r\n    const list: JSX.Element[] = [];\r\n    blockStacks.forEach((blockStack) => {\r\n      if (\r\n        inArray(blockStack.getName(), blockArrows) >= 0 ||\r\n        inArray(blockStack.getName(), Object.keys(arrowList)) >= 0\r\n      ) {\r\n        list.push(\r\n          <g key={blockStack.key}>\r\n            <Block blockStack={blockStack} />\r\n          </g>\r\n        );\r\n      }\r\n    });\r\n    // list  main \r\n    return list;\r\n  }\r\n\r\n  drawOrRemoveBlock(name: string) {\r\n    const arrowListJson = sessionStorage.getItem('arrowList');\r\n    let arrowList = JSON.parse(arrowListJson!);\r\n    if (!arrowList) {\r\n      arrowList = {};\r\n    }\r\n    if (inArray(name, Object.keys(arrowList)) < 0) {\r\n      arrowList[name] = '';\r\n    } else {\r\n      delete arrowList[name];\r\n    }\r\n    sessionStorage.setItem('arrowList', JSON.stringify(arrowList));\r\n    this.setState({});\r\n  }\r\n\r\n  renderStackView() {\r\n    const arrowListJson = sessionStorage.getItem('arrowList');\r\n    let arrowList = JSON.parse(arrowListJson!);\r\n    if (!arrowList) {\r\n      arrowList = {};\r\n    }\r\n    const { blockDrawer } = this.props;\r\n    const blockStacks = blockDrawer.getBlockStacks();\r\n    const blockArrows = blockDrawer.getBlockArrows();\r\n    const list: JSX.Element[] = [];\r\n    const x = 60;\r\n    let y = 50;\r\n    const offsetY = 60;\r\n    const width = 192;\r\n    const height = 108;\r\n    blockStacks.forEach((blockStack, i) => {\r\n      const transform = `matrix(1,0,-0.36,1,0,0)`;\r\n      list.push(\r\n        <g\r\n          key={`stack_${blockStack.getName()}`}\r\n          id={`stack_${blockStack.getName()}`}\r\n          onClick={() => {\r\n            const res = inArray(blockStack.getName(), blockArrows);\r\n            if (res < 0) {\r\n              this.drawOrRemoveBlock(blockStack.getName());\r\n            }\r\n          }}\r\n        >\r\n          <rect\r\n            x={x}\r\n            y={y}\r\n            width={width}\r\n            height={height}\r\n            transform={transform}\r\n            fill=\"white\"\r\n            stroke=\"#979797\"\r\n            strokeWidth={2}\r\n            transform-origin={x + ' ' + y}\r\n          ></rect>\r\n          <text\r\n            x={x + 10}\r\n            y={y + 20}\r\n            fontSize=\"15\"\r\n            className=\"function-name\"\r\n            fill={'rgb(139, 139, 139)' }\r\n          >\r\n            {blockStack.getName().split('_')[0]}\r\n          </text>\r\n        </g>\r\n      );\r\n      y = y + offsetY;\r\n    });\r\n    return list;\r\n  }\r\n\r\n  render() {\r\n    const stacks = this.renderStackView();\r\n    const blocks = this.renderBlocks();\r\n    const { blockDrawer } = this.props;\r\n    const blockArrows = blockDrawer.getBlockArrows();\r\n    blockArrows.forEach((stackName: string) => {\r\n      if (stackName) {\r\n        sessionStorage.setItem('activeStack', stackName);\r\n      }\r\n    });\r\n    return (\r\n      <React.Fragment>\r\n        {stacks}\r\n        {blocks}\r\n      </React.Fragment>\r\n    );\r\n  }\r\n}\r\n","import { ExecState } from 'unicoen.ts/dist/interpreter/Engine/ExecState';\r\nimport { Stack } from 'unicoen.ts/dist/interpreter/Engine/Stack';\r\nimport { UniVariableDef } from 'unicoen.ts/dist/node/UniVariableDef';\r\nimport { arrayToString } from '../blockDrawer/BlockDrawer';\r\nimport { inArray } from 'jquery';\r\n\r\nexport class AnimationDrawer {\r\n  private execState: ExecState | undefined = undefined;\r\n  private lastState: ExecState | undefined = undefined;\r\n  private state!: string;\r\n  private variableKeys!: string[];\r\n  private variableTypes!: string[];\r\n  private variableValues!: any[];\r\n  private postArgs!: any[];\r\n  private stack: Stack | undefined = undefined;\r\n  constructor(execState?: ExecState, lastState?: ExecState) {\r\n    if (typeof execState === 'undefined') return;\r\n    this.execState = execState;\r\n    if (typeof lastState === 'undefined') return;\r\n    this.lastState = lastState;\r\n    this.reset();\r\n    this.getCurrentStack();\r\n    this.parseExe();\r\n  }\r\n\r\n  public reset() {\r\n    this.state = '';\r\n    this.stack = undefined;\r\n    this.postArgs = [];\r\n    this.variableKeys = [];\r\n    this.variableTypes = [];\r\n    this.variableValues = [];\r\n  }\r\n\r\n  private parseExe() {\r\n    const currentExpr = this.execState!.getCurrentExpr();\r\n    const currentClassName = currentExpr.constructor.name;\r\n    let lastClassName = '';\r\n    let lastExpr = undefined;\r\n    let flag = true;\r\n    if (this.lastState) {\r\n      if (\r\n        this.execState!.getStacks().length < this.lastState.getStacks().length\r\n      ) {\r\n        // flag = false;\r\n      }\r\n      lastExpr = this.lastState.getNextExpr();\r\n      lastClassName = lastExpr.constructor.name;\r\n    }\r\n    if (flag) {\r\n      switch (currentClassName) {\r\n        case 'UniProgram':\r\n          this.state = 'programInit';\r\n          break;\r\n        case 'UniVariableDec':\r\n          this.state = 'variablesInit';\r\n          this.variableDec(currentExpr);\r\n          break;\r\n        case 'UniMethodCall':\r\n          this.methodCall(currentExpr);\r\n          break;\r\n        case 'UniBinOp':\r\n          this.binOp(currentExpr);\r\n          break;\r\n      }\r\n      switch (lastClassName) {\r\n        case 'UniBinOp':\r\n          this.binOp(lastExpr);\r\n          break;\r\n        case 'UniReturn':\r\n          this.state = 'uniReturn';\r\n          this.uniReturn(lastExpr);\r\n          break;\r\n        case 'UniVariableDec':\r\n          this.variableKeys = [];\r\n          this.variableTypes = [];\r\n          this.variableValues = [];\r\n          this.state = 'variablesInit';\r\n          this.variableDec(lastExpr);\r\n          break;\r\n      }\r\n    }\r\n    console.log(this);\r\n  }\r\n\r\n  public binOp(uniBinOp: any) {\r\n    const operator = uniBinOp.operator;\r\n    const right = uniBinOp.right;\r\n    const rightClassName = right.constructor.name;\r\n    switch (rightClassName) {\r\n      case 'UniMethodCall':\r\n        this.methodCall(right);\r\n        break;\r\n      case 'UniBinOp':\r\n        this.binOp(right);\r\n        break;\r\n    }\r\n    if (operator !== '=') {\r\n      const left = uniBinOp.left;\r\n      const leftClassName = left.constructor.name;\r\n      switch (leftClassName) {\r\n        case 'UniMethodCall':\r\n          this.methodCall(left);\r\n          break;\r\n        case 'UniBinOp':\r\n          this.binOp(left);\r\n          break;\r\n      }\r\n    }\r\n  }\r\n\r\n  public methodCall(uniMethodCall: any) {\r\n    const methodName = uniMethodCall.methodName.name;\r\n    this.execState!.getStacks().forEach((stack) => {\r\n      if (methodName === stack.name) {\r\n        this.state = 'methodCall';\r\n        this.postArgs = [];\r\n        this.getMethodArgs(uniMethodCall);\r\n        return;\r\n      }\r\n    });\r\n    this.lastState!.getStacks().forEach((stack) => {\r\n      if (methodName === stack.name) {\r\n        this.state = 'methodCall';\r\n        this.postArgs = [];\r\n        this.getMethodArgs(uniMethodCall);\r\n        return;\r\n      }\r\n    });\r\n  }\r\n\r\n  public variableDec(uniVariableDec: any) {\r\n    const variables = uniVariableDec.variables;\r\n    if (variables) {\r\n      variables.forEach((variable: UniVariableDef) => {\r\n        this.variableDef(variable);\r\n      });\r\n    }\r\n  }\r\n\r\n  public variableDef(uniVariableDef: UniVariableDef) {\r\n    let key = this.stack!.name + '-' + uniVariableDef.name;\r\n    key = key.replace(/[&\\|\\\\\\*:^%$@()\\[\\].]/g, '_');\r\n    const variableValue = uniVariableDef.value;\r\n    if (!variableValue) return;\r\n    const valueClass = variableValue.constructor.name;\r\n    switch (valueClass) {\r\n      case 'UniMethodCall':\r\n        this.methodCall(variableValue);\r\n        break;\r\n      case 'UniBinOp':\r\n        this.binOp(variableValue);\r\n        break;\r\n    }\r\n    const variables = this.stack!.getVariables();\r\n    for (let i = 0; i < variables.length; i++) {\r\n      if (variables[i].getName() === uniVariableDef.name) {\r\n        const type = variables[i].type;\r\n        const value = variables[i].getValue();\r\n        this.variableKeys.push(key);\r\n        this.variableTypes.push(type);\r\n        if (type.split('[').length > 1) {\r\n          this.variableValues.push(arrayToString(value, type.split('[')[0]));\r\n        } else {\r\n          if (inArray(type.split('[')[0], ['char', 'unsignedchar']) < 0) {\r\n            this.variableValues.push(value);\r\n          } else {\r\n            this.variableValues.push(String.fromCharCode(value));\r\n          }\r\n        }\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  public uniReturn(uniReturn: any) {\r\n    const currentExpr = this.execState!.getCurrentExpr();\r\n    const currentClassName = currentExpr.constructor.name;\r\n    // if (currentClassName !== 'UniVariableDec') {\r\n    //   return;\r\n    // }\r\n    const returnValue = uniReturn.value;\r\n    if (!returnValue) {\r\n      return;\r\n    }\r\n    this.postArgs = [];\r\n    this.travelValue(returnValue);\r\n    // this.variableDec(currentExpr);\r\n  }\r\n\r\n  private travelValue(returnValue: any) {\r\n    let returnValueClass = returnValue.constructor.name;\r\n    if (returnValueClass === 'UniIdent') {\r\n      this.postArgs.push(\r\n        (\r\n          this.lastState!.getStacks()[this.lastState!.getStacks().length - 1]\r\n            .name +\r\n          '-' +\r\n          returnValue.name\r\n        ).replace(/[&\\|\\\\\\*:^%$@()\\[\\].]/g, '_')\r\n      );\r\n      return;\r\n    } else if (returnValueClass === 'UniBinOp') {\r\n      this.travelValue(returnValue.left);\r\n      this.travelValue(returnValue.right);\r\n    }\r\n  }\r\n\r\n  private travelArg(arg: any, idx: number) {\r\n    let returnValueClass = arg.constructor.name;\r\n    if (this.postArgs.length === idx) {\r\n      this.postArgs.push(undefined);\r\n    }\r\n    if (returnValueClass === 'UniIdent') {\r\n      if (this.postArgs[idx] === undefined) {\r\n        this.postArgs[idx] = (\r\n          this.lastState!.getStacks()[this.lastState!.getStacks().length - 1]\r\n            .name +\r\n          '-' +\r\n          arg.name\r\n        ).replace(/[&\\|\\\\\\*:^%$@()\\[\\].]/g, '_');\r\n      }\r\n      return;\r\n    } else if (returnValueClass === 'UniBinOp') {\r\n      this.travelArg(arg.left, idx);\r\n      this.travelArg(arg.right, idx);\r\n    }\r\n  }\r\n\r\n  public getMethodArgs(uniMethodCall: any) {\r\n    const args = uniMethodCall.args;\r\n    const variables = this.stack!.getVariables();\r\n    args.forEach((arg: any, idx: number) => {\r\n      this.travelArg(arg, idx);\r\n      const type = variables[idx].type;\r\n      const value = variables[idx].getValue();\r\n      this.variableKeys.push(\r\n        (this.stack!.name + '-' + variables[idx].name).replace(\r\n          /[&\\|\\\\\\*:^%$@()\\[\\].]/g,\r\n          '_'\r\n        )\r\n      );\r\n      this.variableTypes.push(type);\r\n      if (type.split('[').length > 1) {\r\n        this.variableValues.push(arrayToString(value, type.split('[')[0]));\r\n      } else {\r\n        if (inArray(type.split('[')[0], ['char', 'unsignedchar']) < 0) {\r\n          this.variableValues.push(value);\r\n        } else {\r\n          this.variableValues.push(String.fromCharCode(value));\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  public getCurrentStack() {\r\n    const stacks = this.execState!.getStacks();\r\n    const stack = stacks[stacks.length - 1];\r\n    this.stack = stack;\r\n    return stack;\r\n  }\r\n\r\n  public getState() {\r\n    return this.state;\r\n  }\r\n\r\n  public getVariableKeys() {\r\n    return this.variableKeys;\r\n  }\r\n\r\n  public getVariableTypes() {\r\n    return this.variableTypes;\r\n  }\r\n\r\n  public getVariableValues() {\r\n    return this.variableValues;\r\n  }\r\n\r\n  public getStackName() {\r\n    if (this.stack) {\r\n      let res = this.stack.name.replace(/[&\\|\\\\\\*:^%$@()\\[\\].]/g, '_');\r\n      return res;\r\n    }\r\n    return '';\r\n  }\r\n\r\n  public getStacks() {\r\n    if (this.execState) {\r\n      return this.execState.getStacks();\r\n    }\r\n    return [];\r\n  }\r\n\r\n  public getPostArgs() {\r\n    return this.postArgs;\r\n  }\r\n}\r\n","import React from 'react';\r\nimport PanelHeader from '../../components/panelHeader/PanelHeader';\r\nimport CallStack from '../../components/callStack/CallStack';\r\nimport Animation from '../../components/callStack/animation/Animation';\r\nimport { AnimationDrawer } from '../../components/callStack/animation/AnimationDrawer';\r\nimport { slot, remove } from '../../components/emitter';\r\nimport { ExecState } from 'unicoen.ts/dist/interpreter/Engine/ExecState';\r\nimport { BlockDrawer } from '../../components/callStack/blockDrawer/BlockDrawer';\r\n\r\nimport './style.scss';\r\nimport { VariableWithSteps } from '../timelinePanel/TimelinePanel';\r\nimport { Variable } from 'unicoen.ts/dist/interpreter/Engine/Variable';\r\nimport * as d3 from 'd3';\r\n\r\ninterface Props {\r\n  height: number;\r\n  width: number;\r\n  execState?: ExecState;\r\n  lastState?: ExecState;\r\n  variableShowUps: VariableWithSteps[] | undefined;\r\n}\r\ninterface State {}\r\n\r\nclass CallStackPanel extends React.Component<Props, State> {\r\n  componentDidUpdate() {\r\n    const variableShowUps = this.props.variableShowUps;\r\n    const execState = this.props.execState;\r\n    const lastState = this.props.lastState;\r\n    if (lastState && execState && variableShowUps) {\r\n      variableShowUps.forEach((variableWithSteps) => {\r\n        if (variableChanged(variableWithSteps, lastState, execState)) {\r\n          // console.log(\r\n          //   'CHANGE|' +\r\n          //     variableWithSteps.funcName +\r\n          //     ': ' +\r\n          //     variableWithSteps.name\r\n          // );\r\n          highlightChangedVariable(\r\n            variableWithSteps.funcName,\r\n            variableWithSteps.name\r\n          );\r\n        } else {\r\n          resetVariableColor(\r\n            variableWithSteps.funcName,\r\n            variableWithSteps.name\r\n          );\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    // console.log('render1');\r\n    const blockDrawer = new BlockDrawer(this.props.execState);\r\n    const animationDrawer = new AnimationDrawer(\r\n      this.props.execState,\r\n      this.props.lastState\r\n    );\r\n    // console.log('render2');\r\n    return (\r\n      <div id=\"CallStackPanel\" className=\"panel\">\r\n        <PanelHeader title=\"Call Stack\" />\r\n        <div className=\"callStack-area\">\r\n          {/* {console.log('DEBUG|'+this.props.execState)} */}\r\n          <svg\r\n            id=\"svg\"\r\n            width={this.props.width - 20}\r\n            height={this.props.height * 0.75 - 28 - 39.2}\r\n          >\r\n            <marker\r\n              id=\"end\"\r\n              viewBox=\"-10 -10 20 20\"\r\n              refX=\"0\"\r\n              refY=\"0\"\r\n              markerWidth=\"8\"\r\n              markerHeight=\"8\"\r\n              orient=\"auto\"\r\n            >\r\n              <circle\r\n                cx={0}\r\n                cy={0}\r\n                style={{ stroke: '#483647', strokeWidth: 2, fill: 'white' }}\r\n                r={8}\r\n              ></circle>\r\n            </marker>\r\n            <marker\r\n              id=\"start\"\r\n              viewBox=\"-10 -10 20 20\"\r\n              refX=\"0\"\r\n              refY=\"0\"\r\n              markerWidth=\"8\"\r\n              markerHeight=\"8\"\r\n              orient=\"auto\"\r\n            >\r\n              <circle\r\n                cx={0}\r\n                cy={0}\r\n                style={{ stroke: '#979797', strokeWidth: 2, fill: 'white' }}\r\n                r={8}\r\n              ></circle>\r\n            </marker>\r\n            <CallStack blockDrawer={blockDrawer}></CallStack>\r\n            <g id=\"clone\"></g>\r\n            <g id=\"path\"></g>\r\n          </svg>\r\n          {/* <Animation\r\n            animationDrawer={\r\n              new AnimationDrawer(this.props.execState, this.props.lastState)\r\n            }\r\n          ></Animation> */}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default CallStackPanel;\r\n\r\nconst variableChanged = (\r\n  variableWithSteps: VariableWithSteps,\r\n  lastState: ExecState,\r\n  execState: ExecState\r\n) => {\r\n  const stackName = variableWithSteps.funcName;\r\n  const variable = variableWithSteps.variable;\r\n  const lastStacks = lastState.getStacks();\r\n  const execStacks = execState.getStacks();\r\n  let lastValue: any = undefined;\r\n  let curValue: any = undefined;\r\n  lastStacks.forEach((stack) => {\r\n    if (stackName !== stack.name) return;\r\n    // console.log('FIND');\r\n    // console.log(variable);\r\n    // console.log(stack.getVariables());\r\n    lastValue = getValueFromStack(variable, stack.getVariables());\r\n    // console.log('GOT');\r\n    // console.log(lastValue);\r\n    if (lastValue !== undefined) return;\r\n  });\r\n  execStacks.forEach((stack) => {\r\n    if (stackName !== stack.name) return;\r\n    curValue = getValueFromStack(variable, stack.getVariables());\r\n    if (curValue !== undefined) return;\r\n  });\r\n  // console.log('last| ' + lastStacks);\r\n  // console.log('exec| ' + execStacks);\r\n  // console.log(\r\n  //   'VC| find ' +\r\n  //     stackName +\r\n  //     ' | ' +\r\n  //     variableWithSteps.name +\r\n  //     ' last: ' +\r\n  //     lastValue +\r\n  //     ' cur: ' +\r\n  //     curValue\r\n  // );\r\n  // console.log(lastValue, curValue);\r\n  // console.log(\r\n  //   lastValue !== undefined,\r\n  //   curValue !== undefined,\r\n  //   lastValue === curValue,\r\n  //   lastValue !== curValue,\r\n  // );\r\n  return (\r\n    lastValue !== undefined &&\r\n    curValue !== undefined &&\r\n    lastValue.toString() !== curValue.toString()\r\n  );\r\n};\r\n\r\nconst getValueFromStack = (targetVariable: Variable, variables: Variable[]) => {\r\n  let ret = undefined;\r\n  variables.forEach((variable) => {\r\n    const value = variable.getValue();\r\n    if (value instanceof Array) {\r\n      const v = getValueFromStack(targetVariable, value);\r\n      if (v !== undefined) {\r\n        return v;\r\n      }\r\n    } else {\r\n      // console.log('CMP');\r\n      // console.log(targetVariable.address);\r\n      // console.log(variable.address);\r\n      if (targetVariable.address === variable.address) {\r\n        ret = value;\r\n        return;\r\n      }\r\n    }\r\n  });\r\n  return ret;\r\n};\r\n\r\nconst highlightChangedVariable = (funcName: string, varName: string) => {\r\n  const blockElement = d3.select('#block-' + funcName + '-' + varName);\r\n  const highlightColor = 'rgb(74, 140, 227)';\r\n\r\n  blockElement.select('.variable-name').attr('fill', highlightColor);\r\n  blockElement.select('.variable-value').attr('fill', highlightColor);\r\n  blockElement.select('rect').attr('style', 'stroke: ' + highlightColor);\r\n};\r\n\r\nconst resetVariableColor = (funcName: string, varName: string) => {\r\n  const defaultColor = 'rgb(139, 139, 139)';\r\n  const blockElement = d3.select('#block-' + funcName + '-' + varName);\r\n\r\n  blockElement.select('.variable-name').attr('fill', defaultColor);\r\n  blockElement.select('.variable-value').attr('fill', defaultColor);\r\n  blockElement.select('rect').attr('style', 'stroke: ' + defaultColor);\r\n};\r\n","import classNames from 'classnames';\r\nimport React from 'react';\r\nimport { Variable } from 'unicoen.ts/dist/interpreter/Engine/Variable';\r\nimport './style.scss';\r\n\r\nexport interface MemoryCellProps {\r\n  variable: Variable;\r\n  selectedVar: Variable | undefined;\r\n  handleClick: (variable: Variable) => void;\r\n}\r\n\r\nfunction MemoryCell({ variable, selectedVar, handleClick }: MemoryCellProps) {\r\n  const varName = variable.name;\r\n  const dataType = variable.type;\r\n  const address = variable.address;\r\n\r\n  const getValue = () => {\r\n    const value = variable.getValue();\r\n    if (dataType === 'char') {\r\n      return \"'\" + value.toString() + \"'\";\r\n    }\r\n    if (value instanceof Array) {\r\n      const fv = firstVarInArr(value);\r\n      return '0x' + fv.address.toString(16);\r\n    }\r\n    return value.toString();\r\n  };\r\n\r\n  return dataType[-1] !== ']' ? (\r\n    <div\r\n      className={classNames('memory-cell', {\r\n        active: selectedVar?.address === address,\r\n        'in-heap': varName === '',\r\n      })}\r\n      onClick={() => {\r\n        handleClick(variable);\r\n      }}\r\n    >\r\n      <div className=\"col-name variable-name\">{varName}</div>\r\n      <div className=\"col-value\">\r\n        <div className=\"col-1\">{dataType}</div>\r\n        <div className=\"col-2\">{getValue()}</div>\r\n      </div>\r\n    </div>\r\n  ) : (\r\n    <div></div>\r\n  );\r\n}\r\n\r\nexport default MemoryCell;\r\n\r\nfunction firstVarInArr(arr: Array<Variable>) {\r\n  while (arr[0].getValue() instanceof Array) {\r\n    arr = arr[0].getValue();\r\n  }\r\n  return arr[0];\r\n}\r\n","import React from 'react';\r\nimport { Variable } from 'unicoen.ts/dist/interpreter/Engine/Variable';\r\nimport MemoryCell from './MemoryCell';\r\nimport './style.scss';\r\n\r\ninterface MemoryBlockProps {\r\n  funcName: string;\r\n  variables: Variable[];\r\n  selectedVar: Variable | undefined;\r\n  handleClick: (variable: Variable) => void;\r\n  // memoryCells: {varName: string; dataType: string; value: string}[];\r\n}\r\n\r\nfunction MemoryBlock({\r\n  funcName,\r\n  variables,\r\n  selectedVar,\r\n  handleClick,\r\n}: MemoryBlockProps) {\r\n  return (\r\n    <div className=\"memory-block\">\r\n      <div className=\"highlight-bar\"></div>\r\n      <div className=\"main-content\">\r\n        <div className=\"function-name\">{funcName}</div>\r\n        <div className=\"cells\">\r\n          {variables.map((variable) => {\r\n            const value = variable.getValue();\r\n\r\n            return value instanceof Array ? (\r\n              <MemoryCell\r\n                key={variable.name}\r\n                variable={variable}\r\n                selectedVar={selectedVar}\r\n                handleClick={handleClick}\r\n              />\r\n            ) : (\r\n              <MemoryCell\r\n                key={variable.name}\r\n                variable={variable}\r\n                selectedVar={selectedVar}\r\n                handleClick={handleClick}\r\n              />\r\n            );\r\n          })}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default MemoryBlock;\r\n","import { type } from 'os';\r\nimport React, { useEffect, useState } from 'react';\r\nimport { ExecState } from 'unicoen.ts/dist/interpreter/Engine/ExecState';\r\nimport { Stack } from 'unicoen.ts/dist/interpreter/Engine/Stack';\r\nimport { Variable } from 'unicoen.ts/dist/interpreter/Engine/Variable';\r\nimport MemoryBlock from './memoryBlock/MemoryBlock';\r\nimport MemoryCell, { MemoryCellProps } from './memoryBlock/MemoryCell';\r\n\r\nimport './style.scss';\r\n\r\ninterface LogicalViewProps {\r\n  execState: ExecState | undefined;\r\n  selectedVar: Variable | undefined;\r\n  handleClick: (variable: Variable) => void;\r\n}\r\n\r\nconst example_var0 = new Variable('int', '', -1, 10008, 2);\r\nconst example_var1 = new Variable('int', '', 2100000000, 10000, 2);\r\nconst example_var2 = new Variable('int', 'a', -2, 10004, 2);\r\nconst example_var3 = new Variable('int', 'b', 10, 10006, 2);\r\nconst example_var4 = new Variable('char', 'c', 'c', 10010, 2);\r\n\r\nfunction LogicalView({\r\n  execState,\r\n  selectedVar,\r\n  handleClick,\r\n}: LogicalViewProps) {\r\n  const [allStacks, setAllStacks] = useState<Stack[]>([]);\r\n  const [heap, setHeap] = useState<Variable[]>([]);\r\n  const [global, setGlobal] = useState<Variable[]>([]);\r\n\r\n  useEffect(() => {\r\n    if (execState !== undefined) {\r\n      const stacks = execState.getStacks();\r\n      const curStacks: Stack[] = [];\r\n      const curHeap: Variable[] = [];\r\n      const curGlobal: Variable[] = [];\r\n\r\n      // console.log('DEBUG| Stacks: ' + stacks);\r\n\r\n      stacks.forEach((stack) => {\r\n        if (stack.name !== 'GLOBAL') {\r\n          curStacks.push(stack);\r\n        } else {\r\n          const variables = stack.getVariables();\r\n          variables.forEach((variable) => {\r\n            if (variable.address >= 50000) {\r\n              curGlobal.push(variable);\r\n            } else if (variable.address >= 20000) {\r\n              curHeap.push(variable);\r\n            }\r\n          });\r\n        }\r\n      });\r\n\r\n      setAllStacks(curStacks);\r\n      setHeap(curHeap);\r\n      setGlobal(curGlobal);\r\n    }\r\n  }, [execState]);\r\n\r\n  return (\r\n    <div id=\"LogicalView\">\r\n      <div className='left-content'>\r\n      <div id=\"StackView\" className=\"content-view\">\r\n        <div className=\"title\"> Stack</div>\r\n        <div className=\"content\">\r\n          {allStacks.map((stack) => {\r\n            const p = stack.name.indexOf('.');\r\n            const stackName = p > 0 ? stack.name.substring(0, p) : stack.name;\r\n            return (\r\n              <MemoryBlock\r\n                key={stack.name}\r\n                funcName={stackName}\r\n                variables={stack.getVariables()}\r\n                selectedVar={selectedVar}\r\n                handleClick={handleClick}\r\n              />\r\n            );\r\n          })}\r\n          {/* <MemoryBlock funcName=\"functionX\" memoryCells={memoryCells} /> */}\r\n        </div>\r\n      </div></div>\r\n      <div className='right-content'>\r\n        <div id=\"HeapView\" className=\"content-view\">\r\n          <div className=\"title\">Heap</div>\r\n          <div className=\"content\">\r\n            {/* <MemoryCell\r\n              variable={example_var1}\r\n              selectedVar={selectedVar}\r\n              handleClick={handleClick}\r\n            />\r\n            <MemoryCell\r\n              variable={example_var0}\r\n              selectedVar={selectedVar}\r\n              handleClick={handleClick}\r\n            /> */}\r\n          </div>\r\n        </div>\r\n        <div id=\"GlobalStaticView\" className=\"content-view\">\r\n          <div className=\"title\">Global / Static</div>\r\n          <div className=\"content\">\r\n            {/* <div style={{border: '1px solid black', height: '2rem'}}></div> */}\r\n            {/* <MemoryCell\r\n              variable={example_var2}\r\n              selectedVar={selectedVar}\r\n              handleClick={handleClick}\r\n            />\r\n            <MemoryCell\r\n              variable={example_var3}\r\n              selectedVar={selectedVar}\r\n              handleClick={handleClick}\r\n            />\r\n            <MemoryCell\r\n              variable={example_var4}\r\n              selectedVar={selectedVar}\r\n              handleClick={handleClick}\r\n            /> */}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default LogicalView;\r\n","export default __webpack_public_path__ + \"static/media/intLegend1.836ad3c4.svg\";","export default __webpack_public_path__ + \"static/media/intLegend2.7a6d9041.svg\";","export default __webpack_public_path__ + \"static/media/intLegend3.36d91a6d.svg\";","export default __webpack_public_path__ + \"static/media/intLegend4.160d8537.svg\";","export default __webpack_public_path__ + \"static/media/intMark1.e715f7c2.svg\";","export default __webpack_public_path__ + \"static/media/intMark2.f963dd7f.svg\";","import React from 'react';\r\nimport { Variable } from 'unicoen.ts/dist/interpreter/Engine/Variable';\r\nimport './style.scss';\r\nimport intLegend1 from '../../../assets/icon/binaryCode/intLegend1.svg';\r\nimport intLegend2 from '../../../assets/icon/binaryCode/intLegend2.svg';\r\nimport intLegend3 from '../../../assets/icon/binaryCode/intLegend3.svg';\r\nimport intLegend4 from '../../../assets/icon/binaryCode/intLegend4.svg';\r\nimport intMark1 from '../../../assets/icon/binaryCode/intMark1.svg';\r\nimport intMark2 from '../../../assets/icon/binaryCode/intMark2.svg';\r\nimport classNames from 'classnames';\r\n\r\ninterface IntegerBinaryCodeProps {\r\n  variable: Variable;\r\n}\r\n\r\nconst IntegerBinaryCode = ({ variable }: IntegerBinaryCodeProps) => {\r\n  const binaryCode0 = signMagn(variable);\r\n  const binaryCode1 = oneComp(variable);\r\n  const binaryCode2 = twoComp(variable);\r\n  const sign = binaryCode0[0] === '1';\r\n  return (\r\n    <svg id=\"IntegerBinaryCode\" height=\"100%\" width=\"100%\" fill=\"#8b8b8b\">\r\n      <text y={16}>Binary Code</text>\r\n      <g id=\"legend\" transform=\"translate(110 5)\">\r\n        <image xlinkHref={intLegend1} />\r\n        <image x={80} xlinkHref={intLegend2} />\r\n        <image x={165} y={2} xlinkHref={intLegend3} />\r\n        <image x={205} y={2} xlinkHref={intLegend4} />\r\n      </g>\r\n      <g id=\"bianryCode0\" className=\"value-text\" transform=\"translate(0 45)\">\r\n        <text>Sign-Magnitude</text>\r\n        <text\r\n          className={classNames(\r\n            'variable-value',\r\n            sign ? 'sign-bit-neg' : 'sign-bit-pos'\r\n          )}\r\n          y={20}\r\n        >\r\n          {binaryCode0.substring(0, 1)}\r\n        </text>\r\n        <text className=\"variable-value\" x={8} y={20}>\r\n          {binaryCode0.substring(1)}\r\n        </text>\r\n      </g>\r\n\r\n      <g id=\"bianryCode1\" className=\"value-text\" transform=\"translate(0 90)\">\r\n        <text>One's Complement</text>\r\n        <text\r\n          className={classNames(\r\n            'variable-value',\r\n            sign ? 'sign-bit-neg' : 'sign-bit-pos'\r\n          )}\r\n          y={20}\r\n        >\r\n          {binaryCode1.substring(0, 1)}\r\n        </text>\r\n        <text className=\"variable-value\" x={8} y={20}>\r\n          {binaryCode1.substring(1)}\r\n        </text>\r\n      </g>\r\n\r\n      <g id=\"bianryCode2\" className=\"value-text\" transform=\"translate(0 135)\">\r\n        <text>Two's Complement</text>\r\n        <text\r\n          className={classNames(\r\n            'variable-value',\r\n            sign ? 'sign-bit-neg' : 'sign-bit-pos'\r\n          )}\r\n          y={20}\r\n        >\r\n          {binaryCode2.substring(0, 1)}\r\n        </text>\r\n        <text className=\"variable-value\" x={8} y={20}>\r\n          {binaryCode2.substring(1)}\r\n        </text>\r\n      </g>\r\n\r\n      <defs>\r\n        <marker\r\n          id=\"arrow-tip\"\r\n          refX=\"8\"\r\n          refY=\"6\"\r\n          viewBox=\"0 0 16 16\"\r\n          markerWidth=\"8\"\r\n          markerHeight=\"8\"\r\n          markerUnits=\"userSpaceOnUse\"\r\n          orient=\"auto\"\r\n        >\r\n          <path d=\"M 0 0 12 6 0 12 3 6 Z\" />\r\n        </marker>\r\n      </defs>\r\n      {sign ? (\r\n        <g>\r\n          <g id=\"underline\">\r\n            <line x1={9} y1={69} x2={250} y2={69}></line>\r\n            <line x1={9} y1={114} x2={250} y2={114}></line>\r\n            <line x1={1} y1={120} x2={250} y2={120}></line>\r\n            <line x1={9} y1={159} x2={250} y2={159}></line>\r\n          </g>\r\n          <g id=\"arrows\">\r\n            <polyline\r\n              points=\"260,69 280,69 280,114 260,114\"\r\n              markerEnd=\"url(#arrow-tip)\"\r\n              fill=\"none\"\r\n            />\r\n            <polyline\r\n              points=\"260,120 280,120 280,159 260,159\"\r\n              markerEnd=\"url(#arrow-tip)\"\r\n              fill=\"none\"\r\n            />\r\n          </g>\r\n\r\n          <g id=\"mark\">\r\n            <image x={290} y={85} xlinkHref={intMark1} />\r\n            <image x={290} y={132} xlinkHref={intMark2} />\r\n          </g>\r\n        </g>\r\n      ) : (\r\n        <g></g>\r\n      )}\r\n    </svg>\r\n  );\r\n};\r\n\r\nexport default IntegerBinaryCode;\r\n\r\nfunction twoComp(variable: Variable) {\r\n  if (variable.type === 'int') {\r\n    const num = variable.getValue();\r\n    if (num >= 0) return signMagn(variable);\r\n    const oneC = oneComp(variable);\r\n    const twoC = '1' + d2b(parseInt(oneC, 2) + 1, 31);\r\n    return twoC;\r\n  }\r\n  return 'X';\r\n}\r\n\r\nfunction d2b(num: number, width: number) {\r\n  return (Array(width).join('0') + num.toString(2))\r\n    .slice(-width)\r\n    .replace('-', '0');\r\n}\r\n\r\nfunction signMagn(variable: Variable) {\r\n  if (variable.type === 'int') {\r\n    const num = variable.getValue();\r\n    const binary = d2b(num, 31);\r\n    return (num >= 0 ? '0' : '1') + binary;\r\n  }\r\n  return 'X';\r\n}\r\n\r\nfunction oneComp(variable: Variable) {\r\n  if (variable.type === 'int') {\r\n    const num = variable.getValue();\r\n\r\n    if (num >= 0) {\r\n      return signMagn(variable);\r\n    }\r\n\r\n    const binary = d2b(num, 31);\r\n    const reg = /1|0/g;\r\n    const oneC = binary.replace(reg, (x: string) => {\r\n      return x === '0' ? '1' : '0';\r\n    });\r\n    return '1' + oneC;\r\n  }\r\n  return 'X';\r\n}\r\n","import classNames from 'classnames';\r\nimport React from 'react';\r\nimport { Variable } from 'unicoen.ts/dist/interpreter/Engine/Variable';\r\nimport './style.scss';\r\ninterface FloatBinaryCodeProps {\r\n  variable: Variable;\r\n}\r\n\r\nconst FloatBinaryCode = ({ variable }: FloatBinaryCodeProps) => {\r\n  const { sign, exponent, mantissa } = float2binary(variable);\r\n\r\n  return (\r\n    <svg id=\"FloatBinaryCode\" height=\"100%\" width=\"100%\" fill=\"#8b8b8b\">\r\n      <text y={16}>Binary Code</text>\r\n      <g transform=\"translate(20, 0)\">\r\n        <text\r\n          y={60}\r\n          className={classNames(\r\n            'variable-value',\r\n            sign === '1' ? 'sign-bit-neg' : 'sign-bit-pos'\r\n          )}\r\n        >\r\n          {sign}\r\n        </text>\r\n        <text x={12} y={60} className=\"variable-value\">\r\n          {exponent}\r\n        </text>\r\n        <text x={80} y={60} className=\"variable-value\">\r\n          {mantissa}\r\n        </text>\r\n        <g id=\"underline\">\r\n          <line x1={0} y1={64} x2={8} y2={64}></line>\r\n          <line x1={12} y1={64} x2={74} y2={64}></line>\r\n          <line x1={80} y1={64} x2={258} y2={64}></line>\r\n        </g>\r\n      </g>\r\n      <g id=\"arrows\">\r\n        <polyline points=\"24,69 12,84\" fill=\"none\" />\r\n        <polyline points=\"63,69 63,84\" fill=\"none\" />\r\n        <polyline points=\"183,69 183,84\" fill=\"none\" />\r\n        <text x={0} y={100}>\r\n          sign\r\n        </text>\r\n        <text x={33} y={100}>\r\n          exponent\r\n        </text>\r\n        <text x={155} y={100}>\r\n          mantissa\r\n        </text>\r\n      </g>\r\n    </svg>\r\n  );\r\n};\r\n\r\nexport default FloatBinaryCode;\r\n\r\nconst float2binary = (variable: Variable) => {\r\n  const value = variable.getValue();\r\n  let binary: string = value.toString(2);\r\n  const sign = binary[0] === '-' ? '1' : '0';\r\n  binary = binary.replace('-', '');\r\n  const pointPos = binary.indexOf('.');\r\n  const firstOne = binary.indexOf('1');\r\n  const exponent = (\r\n    Array(8).join('0') + (pointPos - firstOne - 1 + 127).toString(2)\r\n  ).slice(-8);\r\n  const mantissa = (\r\n    binary.substring(firstOne + 1).replace('.', '') + Array(24).join('0')\r\n  ).slice(0, 23);\r\n  return { sign, exponent, mantissa };\r\n};\r\n","import React from 'react';\r\nimport { Variable } from 'unicoen.ts/dist/interpreter/Engine/Variable';\r\nimport './style.scss';\r\nimport classNames from 'classnames';\r\nimport IntegerBinaryCode from './IntegerBinaryCode';\r\nimport FloatBinaryCode from './FloatBinaryCode';\r\n\r\ninterface BinaryCodeSvgProps {\r\n  variable: Variable;\r\n}\r\n\r\n\r\n\r\nconst DefaultBinayCode = () => {\r\n  return (\r\n    <svg id=\"DefaultBinayCode\" height=\"100%\" width=\"100%\">\r\n      <text y={16} fill=\"#8b8b8b\">\r\n        Binary Code\r\n      </text>\r\n      {/* <g id=\"legend\" transform=\"translate(110 5)\">\r\n        <image xlinkHref={intLegend1} />\r\n        <image x={80} xlinkHref={intLegend2} />\r\n        <image x={165} y={2} xlinkHref={intLegend3} />\r\n        <image x={205} y={2} xlinkHref={intLegend4} />\r\n      </g> */}\r\n    </svg>\r\n  );\r\n};\r\n\r\nconst getBinaryCodeSvg = (variable: Variable) => {\r\n  switch (variable.type) {\r\n    case 'int':\r\n      return <IntegerBinaryCode variable={variable} />;\r\n    case 'float':\r\n      return <FloatBinaryCode variable={variable} />;\r\n    default:\r\n      return <DefaultBinayCode />;\r\n  }\r\n};\r\n\r\nfunction BinaryCodeSvg({ variable }: BinaryCodeSvgProps) {\r\n  return getBinaryCodeSvg(variable);\r\n}\r\n\r\nexport default BinaryCodeSvg;\r\n\r\n","import React, { useEffect } from 'react';\r\nimport { Variable } from 'unicoen.ts/dist/interpreter/Engine/Variable';\r\nimport BinaryCodeSvg from './binaryCodeSvg/BinaryCodeSvg';\r\nimport './style.scss';\r\n\r\nexport interface MemoryInfo {\r\n  funcName: string;\r\n  varName: string;\r\n  address: string;\r\n  type: string;\r\n  value: string;\r\n}\r\n\r\nconst defaultMemoryInfo: MemoryInfo = {\r\n  funcName: 'X',\r\n  varName: 'X',\r\n  address: 'X',\r\n  type: 'X',\r\n  value: 'X',\r\n};\r\n\r\ninterface MemoryDetailProps {\r\n  variable: Variable;\r\n}\r\n\r\nfunction MemoryDetail({ variable }: MemoryDetailProps) {\r\n  const memoryInfo: MemoryInfo =\r\n    variable.address > 0\r\n      ? {\r\n          funcName: 'main',\r\n          varName: variable.name,\r\n          address: '0x' + variable.address.toString(16),\r\n          type: variable.type,\r\n          value: variable.getValue().toString(),\r\n        }\r\n      : defaultMemoryInfo;\r\n  // console.log('DEBUG|'+variable.address);\r\n  return (\r\n    <div id=\"MemoryDetail\">\r\n      <div>\r\n        <div className=\"detail-item\"></div>\r\n        <div className=\"detail-item\">\r\n          <div className=\"item-name\">Function Name</div>\r\n          <div className=\"item-value\">{memoryInfo.funcName}</div>\r\n        </div>\r\n        <div className=\"detail-item\">\r\n          <div className=\"item-name\">Variable Name</div>\r\n          <div className=\"item-value variable-name\">{memoryInfo.varName}</div>\r\n        </div>\r\n        <div className=\"detail-item\">\r\n          <div className=\"item-name\">Address</div>\r\n          <div className=\"item-value\">{memoryInfo.address}</div>\r\n        </div>\r\n        <div className=\"type-value-detail\">\r\n          <div className=\"detail-item dashed-border-right\">\r\n            <div className=\"item-name\">Type</div>\r\n            <div className=\"item-value\">{memoryInfo.type}</div>\r\n          </div>\r\n          <div className=\"detail-item\">\r\n            <div className=\"item-name\">Value</div>\r\n            <div className=\"item-value\">{memoryInfo.value}</div>\r\n          </div>\r\n        </div>\r\n        <div id=\"BinaryCodeSvg\">\r\n          <BinaryCodeSvg variable={variable} />\r\n        </div>\r\n        {/* <div className=\"detail-item binary-item\">\r\n          <div className=\"item-name\">Sign-Magnitude</div>\r\n          <div className=\"item-value binary-code\">{memoryInfo.binaryCode0}</div>\r\n        </div>\r\n        <div className=\"detail-item binary-item\">\r\n          <div className=\"item-name\">One's Complement</div>\r\n          <div className=\"item-value binary-code\">{memoryInfo.binaryCode1}</div>\r\n        </div>\r\n        <div className=\"detail-item binary-item\">\r\n          <div className=\"item-name\">Two's Complement</div>\r\n          <div className=\"item-value binary-code\">{memoryInfo.binaryCode2}</div>\r\n        </div> */}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default MemoryDetail;\r\n","import React from 'react';\r\nimport { ExecState } from 'unicoen.ts/dist/interpreter/Engine/ExecState';\r\nimport { Variable } from 'unicoen.ts/dist/interpreter/Engine/Variable';\r\nimport './style.scss';\r\n\r\ninterface PhysicalViewProps {\r\n  execState: ExecState | undefined;\r\n  selectedVar: Variable | undefined;\r\n  handleClick: (variable: Variable) => void;\r\n}\r\n\r\nfunction PhysicalView({\r\n  execState,\r\n  selectedVar,\r\n  handleClick,\r\n}: PhysicalViewProps) {\r\n  // const a = allVariables ;\r\n  return <div id=\"PhysicalView\">Coming Soon...</div>;\r\n}\r\n\r\nexport default PhysicalView;\r\n","import React from 'react';\r\nimport classNames from 'classnames';\r\nimport './style.scss';\r\ninterface SubtitleBlockProps {\r\n  title: string;\r\n  isActive: boolean;\r\n  handleClick: () => void;\r\n}\r\n\r\nfunction SubtitleBlock({title, isActive, handleClick}: SubtitleBlockProps) {\r\n  return (\r\n    <div\r\n      className={classNames('subtitle-block', {'subtitle-active': isActive})}\r\n      onClick={handleClick}\r\n    >\r\n      {title}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default SubtitleBlock;\r\n","import classNames from 'classnames';\r\nimport React, { useEffect, useState } from 'react';\r\nimport { ExecState } from 'unicoen.ts/dist/interpreter/Engine/ExecState';\r\nimport { Variable } from 'unicoen.ts/dist/interpreter/Engine/Variable';\r\nimport LogicalView from '../../components/memory/LogicalView';\r\nimport MemoryDetail, { MemoryInfo } from '../../components/memory/MemoryDetail';\r\nimport PhysicalView from '../../components/memory/PhysicalView';\r\nimport PanelHeader from '../../components/panelHeader/PanelHeader';\r\nimport SubtitleBlock from '../../components/subtitleBlock/SubtitleBlock';\r\nimport './style.scss';\r\n\r\n// const example_memory: MemoryInfo = {\r\n//   funcName: 'recursiveToThree',\r\n//   varName: 'n',\r\n//   address: '0xc35f',\r\n//   type: 'int',\r\n//   value: '-1',\r\n//   binaryCode0: '1000 0001',\r\n//   binaryCode1: '1000 0001',\r\n//   binaryCode2: '1000 0001',\r\n//   // binaryCode0: '1000 0000 0000 0000 0000 0000 0000 0001',\r\n//   // binaryCode1: '1111 1111 1111 1111 1111 1111 1111 1110',\r\n//   // binaryCode2: '1111 1111 1111 1111 1111 1111 1111 1111',\r\n// };\r\n\r\nconst defaultVar: Variable = new Variable('', '', '', -1, -1);\r\n\r\ninterface MemoryPanelProps {\r\n  execState: ExecState | undefined;\r\n}\r\n\r\nfunction MemoryPanel({ execState }: MemoryPanelProps) {\r\n  const [viewMode, setViewMode] = useState('logical');\r\n  const [selectedVar, setSelectedVar] = useState<Variable>();\r\n  const [lastVar, setLastVar] = useState<Variable>(defaultVar);\r\n\r\n  const handleModeChange = (mode: 'logical' | 'physical') => {\r\n    setViewMode(mode);\r\n  };\r\n\r\n  const handleSelectMemory = (newSelectedVar: Variable) => {\r\n    if (newSelectedVar.address === selectedVar?.address) {\r\n      hideDetail();\r\n    } else {\r\n      setLastVar(selectedVar ? selectedVar : defaultVar);\r\n      setSelectedVar(newSelectedVar);\r\n    }\r\n  };\r\n\r\n  const hideDetail = () => {\r\n    setLastVar(selectedVar ? selectedVar : defaultVar);\r\n    setSelectedVar(undefined);\r\n  };\r\n\r\n  return (\r\n    <div\r\n      id=\"MemoryPanel\"\r\n      className={classNames('panel', {\r\n        'show-detail': selectedVar !== undefined,\r\n        'hide-detail': selectedVar === undefined,\r\n      })}\r\n    >\r\n      <PanelHeader title=\"Memory\" />\r\n      <div className=\"subtitle-1\">\r\n        <div className=\"subtitle-area\">\r\n          <SubtitleBlock\r\n            title=\"Logical View\"\r\n            isActive={viewMode === 'logical'}\r\n            handleClick={() => handleModeChange('logical')}\r\n          />\r\n        </div>\r\n        <div className=\"subtitle-area\">\r\n          <SubtitleBlock\r\n            title=\"Physical View\"\r\n            isActive={viewMode === 'physical'}\r\n            handleClick={() => handleModeChange('physical')}\r\n          />\r\n        </div>\r\n      </div>\r\n      <div className=\"main-area\">\r\n        {viewMode === 'logical' ? (\r\n          <LogicalView\r\n            execState={execState}\r\n            selectedVar={selectedVar}\r\n            handleClick={handleSelectMemory}\r\n          />\r\n        ) : (\r\n          <PhysicalView\r\n            execState={execState}\r\n            selectedVar={selectedVar}\r\n            handleClick={handleSelectMemory}\r\n          />\r\n        )}\r\n      </div>\r\n      <div className=\"subtitle-area\">\r\n        <SubtitleBlock\r\n          title=\"Memory Detail\"\r\n          isActive={selectedVar !== undefined}\r\n          handleClick={() => {\r\n            if (selectedVar !== undefined) {\r\n              hideDetail();\r\n            } else {\r\n              if (lastVar !== undefined) {\r\n                setSelectedVar(lastVar);\r\n              } else {\r\n                setSelectedVar(defaultVar);\r\n                // alert('Click a memory cell to start');\r\n              }\r\n            }\r\n          }}\r\n        />\r\n      </div>\r\n      <div className=\"detail-area\">\r\n        <MemoryDetail variable={selectedVar ? selectedVar : lastVar} />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default MemoryPanel;\r\n","export default __webpack_public_path__ + \"static/media/logo.afd13c96.svg\";","export default __webpack_public_path__ + \"static/media/info.418cedcd.svg\";","export default __webpack_public_path__ + \"static/media/icon2.c3c63206.svg\";","import React from 'react';\r\nimport { Popover } from 'antd';\r\nimport logo from '../../assets/icon/logo.svg';\r\nimport menuIcon1 from '../../assets/icon/info.svg';\r\nimport menuIcon2 from '../../assets/icon/icon2.svg';\r\nimport './style.scss';\r\n\r\nconst title = '';\r\nconst content =  () => {\r\n  return (\r\n    <>\r\n      <p>Source Editor </p>\r\n      <p> Console </p>\r\n      <p>Timeline </p>\r\n      <p>Call Stack </p>\r\n      <p>Memory intfloat</p>\r\n      <p>/ \"Ctrl + Enter\" |  \"\" |  \"\" </p>\r\n      <hr />\r\n      <p> 0\"float a= 0 - 1.0\"</p>\r\n      <p>IDE</p>\r\n      <p>*  19201080   'Ctrl' + '+'/'-' </p>\r\n    </>\r\n  )\r\n}\r\n\r\nfunction AppHeader() {\r\n  return (\r\n    <div id=\"AppHeader\">\r\n      <div className=\"logo\">\r\n        <svg width={400} height={64}>\r\n          <image xlinkHref={logo} height=\"64\" width=\"400\" />\r\n        </svg>\r\n      </div>\r\n      <div className=\"menu\">\r\n          <div></div>\r\n        <div className=\"menu-item\">\r\n          <Popover placement=\"bottom\" title={title} content={content} trigger=\"click\" \r\n         overlayClassName=\"info-popover\">\r\n            <svg width={22} height={22}>\r\n              <image xlinkHref={menuIcon1} height=\"22\" width=\"22\" />\r\n            </svg>\r\n          </Popover>\r\n        </div>\r\n        <div className=\"menu-item\">\r\n          <svg width={20} height={20}>\r\n            <image xlinkHref={menuIcon2} height=\"20\" width=\"20\" />\r\n          </svg>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AppHeader;\r\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport './App.scss';\r\nimport EditorPanel from './panels/editorPanel/EditorPanel';\r\nimport ConsolePanel from './panels/consolePanel/ConsolePanel';\r\nimport TimelinePanel, {\r\n  VariableWithSteps,\r\n} from './panels/timelinePanel/TimelinePanel';\r\nimport CallStackPanel from './panels/callStackPanel/CallStackPanel';\r\nimport MemoryPanel from './panels/memoryPanel/MemoryPanel';\r\nimport ContainerDimensions from 'react-container-dimensions';\r\nimport AppHeader from './components/appHeader/AppHeader';\r\nimport { ExecState } from 'unicoen.ts/dist/interpreter/Engine/ExecState';\r\nimport { remove, slot, showEvents, signal } from './components/emitter';\r\nimport { unstable_batchedUpdates } from 'react-dom';\r\n\r\nimport * as d3 from 'd3';\r\n\r\nfunction App() {\r\n  const [execState, setExecState] = useState<ExecState | undefined>();\r\n  const [lastState, setLastState] = useState<ExecState | undefined>();\r\n  const [variableShowUps, setVariableShowUps] = useState<VariableWithSteps[]>(\r\n    []\r\n  );\r\n  const app = React.createRef<HTMLDivElement>();\r\n\r\n  useEffect(() => {\r\n    slot(\r\n      'draw',\r\n      (execState: ExecState | undefined, lastState: ExecState | undefined) => {\r\n        unstable_batchedUpdates(() => {\r\n          setExecState(execState);\r\n          setLastState(lastState);\r\n        });\r\n      }\r\n    );\r\n    return () => {\r\n      remove('draw');\r\n    };\r\n  }, []);\r\n\r\n  const updVariableShowUps = (variableShowUps: VariableWithSteps[]) => {\r\n    setVariableShowUps(variableShowUps);\r\n  };\r\n\r\n  const handleKeyDown = (e: React.KeyboardEvent) => {\r\n    console.log('Key: ' + e.key);\r\n    switch (e.key) {\r\n      case 'ArrowRight': {\r\n        e.preventDefault();\r\n        signal('debug', 'Step');\r\n        break;\r\n      }\r\n      case 'ArrowLeft': {\r\n        e.preventDefault();\r\n        signal('debug', 'StepBack');\r\n        break;\r\n      }\r\n    }\r\n    if (e.ctrlKey && e.key === 'Enter') {\r\n      app.current?.focus();\r\n      signal('debug', 'Start');\r\n      const arrowListJson = sessionStorage.getItem('arrowList');\r\n      let arrowList = arrowListJson === null ? {} : JSON.parse(arrowListJson);\r\n      if (!arrowList) {\r\n        arrowList = {};\r\n      }\r\n      Object.keys(arrowList).forEach((name) => {\r\n        d3.select('#svg')\r\n          .select(`#block_${name}`)\r\n          .attr('transform', 'matrix(1,0,0,1,0,0)');\r\n      });\r\n      sessionStorage.clear();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"App\" ref={app} onKeyDown={handleKeyDown} tabIndex={-1}>\r\n      <div className=\"Row-1\">\r\n        <AppHeader />\r\n      </div>\r\n      <div className=\"Row-2\">\r\n        <div className=\"Col-1\">\r\n          <EditorPanel />\r\n          <ConsolePanel />\r\n        </div>\r\n        <div className=\"Col-2\">\r\n          <ContainerDimensions>\r\n            {({ width, height }: { width: number; height: number }) => (\r\n              <React.Fragment>\r\n                <TimelinePanel\r\n                  variableShowUps={variableShowUps}\r\n                  updVariableShowUps={updVariableShowUps}\r\n                />\r\n                <CallStackPanel\r\n                  width={width}\r\n                  height={height}\r\n                  execState={execState}\r\n                  lastState={lastState}\r\n                  variableShowUps={variableShowUps}\r\n                />\r\n              </React.Fragment>\r\n            )}\r\n          </ContainerDimensions>\r\n        </div>\r\n        <div className=\"Col-3\">\r\n          <MemoryPanel execState={execState} />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\nimport { createStore} from 'redux';\r\nimport { Provider } from 'react-redux';\r\nimport reducer from './store';\r\nconst store = createStore(reducer as any);\r\n\r\nReactDOM.render(\r\n  <Provider store={store}>\r\n    <React.StrictMode>\r\n      <App />\r\n    </React.StrictMode>\r\n  </Provider>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n","import {EventEmitter} from 'events';\nexport const emitter = new EventEmitter();\nemitter.setMaxListeners(20);\nexport type event =\n  | 'debug'\n  | 'changeTheme'\n  | 'changeLang'\n  | 'changeProgLang'\n  | 'changeState'\n  | 'changeOutput'\n  | 'zoom'\n  | 'draw'\n  | 'redraw'\n  | 'EOF'\n  | 'stdin'\n  | 'Breakpoint'\n  | 'files'\n  | 'changeStep'\n  | 'jumpTo'\n  | 'init'\n  | 'statementHighlight'\n  | 'cancelStatementHighlight';\nexport const slot = (\n  event: event,\n  listener: (...args: any[]) => void\n): EventEmitter => {\n  return emitter.on(event, listener);\n};\nexport const signal = (event: event, ...args: any[]): boolean => {\n  // console.log('Log | signal: ' + event + ' ' + args);\n  return emitter.emit(event, ...args);\n};\nexport const remove = (event: event) => {\n  emitter.removeAllListeners(event);\n};\n\nexport const showEvents = () => {\n  const eventNames = emitter.eventNames();\n  console.log('Eventnames: ' + eventNames);\n};\n"],"sourceRoot":""}